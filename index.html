<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#6B46C1">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Planner ULTRA">
    <meta name="description" content="Organize sua vida com gamifica√ß√£o - Planner Premium ULTRA">
    
    <title>‚ú® Planner Premium ULTRA</title>
    
    <link rel="manifest" href="/manifest.json">
    <link rel="apple-touch-icon" href="/icons/icon-192.png">
    <link rel="icon" type="image/png" href="/icons/icon-72.png">
    
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    
    <style>
        :root {
            --primary: #6B46C1;
            --primary-dark: #553C9A;
            --secondary: #EC4899;
            --success: #10B981;
            --danger: #EF4444;
            --warning: #F59E0B;
            --info: #3B82F6;
            --dark: #1F2937;
            --light: #F9FAFB;
            --gray: #E5E7EB;
            --gray-dark: #6B7280;
            --gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --gradient-btn: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            --shadow: 0 4px 15px rgba(0,0,0,0.08);
            --shadow-lg: 0 10px 40px rgba(0,0,0,0.15);
            --radius: 12px;
            --radius-sm: 8px;
            --radius-lg: 20px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--light);
            color: var(--dark);
            min-height: 100vh;
            line-height: 1.6;
        }

        /* Loading Screen */
        #loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--gradient);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            transition: opacity 0.5s, visibility 0.5s;
        }

        #loading-screen.hidden {
            opacity: 0;
            visibility: hidden;
        }

        .loader {
            width: 60px;
            height: 60px;
            border: 4px solid rgba(255,255,255,0.3);
            border-top-color: white;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        #loading-screen p {
            color: white;
            margin-top: 1.5rem;
            font-size: 1.1rem;
            font-weight: 500;
        }

        /* Auth Screen */
        #auth-screen {
            min-height: 100vh;
            background: var(--gradient);
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 1rem;
        }

        .auth-container {
            background: white;
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-lg);
            width: 100%;
            max-width: 420px;
            overflow: hidden;
        }

        .auth-header {
            background: var(--gradient);
            padding: 2rem;
            text-align: center;
            color: white;
        }

        .auth-header h1 {
            font-size: 1.8rem;
            margin-bottom: 0.5rem;
        }

        .auth-header p {
            opacity: 0.9;
            font-size: 0.95rem;
        }

        .trial-badge {
            display: inline-block;
            background: rgba(255,255,255,0.2);
            padding: 0.5rem 1rem;
            border-radius: 50px;
            margin-top: 1rem;
            font-weight: 600;
            backdrop-filter: blur(10px);
        }

        .auth-tabs {
            display: flex;
            border-bottom: 2px solid var(--gray);
        }

        .auth-tab {
            flex: 1;
            padding: 1rem;
            text-align: center;
            cursor: pointer;
            font-weight: 600;
            color: var(--gray-dark);
            transition: all 0.3s;
            border: none;
            background: none;
        }

        .auth-tab.active {
            color: var(--primary);
            border-bottom: 3px solid var(--primary);
            margin-bottom: -2px;
        }

        .auth-form {
            padding: 2rem;
        }

        .form-group {
            margin-bottom: 1.25rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: var(--dark);
            font-size: 0.9rem;
        }

        .form-group input, .form-group select, .form-group textarea {
            width: 100%;
            padding: 0.875rem 1rem;
            border: 2px solid var(--gray);
            border-radius: var(--radius-sm);
            font-size: 1rem;
            transition: border-color 0.3s, box-shadow 0.3s;
            font-family: inherit;
        }

        .form-group input:focus, .form-group select:focus, .form-group textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(107, 70, 193, 0.1);
        }

        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            padding: 0.875rem 1.5rem;
            border: none;
            border-radius: var(--radius-sm);
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            font-family: inherit;
        }

        .btn-primary {
            background: var(--gradient-btn);
            color: white;
            width: 100%;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(107, 70, 193, 0.4);
        }

        .btn-secondary {
            background: var(--gray);
            color: var(--dark);
        }

        .btn-success {
            background: var(--success);
            color: white;
        }

        .btn-danger {
            background: var(--danger);
            color: white;
        }

        .btn-sm {
            padding: 0.5rem 1rem;
            font-size: 0.875rem;
        }

        .btn-icon {
            width: 40px;
            height: 40px;
            padding: 0;
            border-radius: 50%;
        }

        /* Main App */
        #main-app {
            display: none;
            min-height: 100vh;
            padding-bottom: 2rem;
        }

        /* Navbar */
        .navbar {
            background: var(--gradient);
            padding: 1rem 1.5rem;
            color: white;
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: var(--shadow);
        }

        .navbar-content {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .navbar-brand {
            font-size: 1.3rem;
            font-weight: 700;
        }

        .navbar-user {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            flex-wrap: wrap;
        }

        .user-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.4rem;
            background: rgba(255,255,255,0.2);
            padding: 0.4rem 0.75rem;
            border-radius: 50px;
            font-size: 0.85rem;
            font-weight: 600;
            backdrop-filter: blur(10px);
            cursor: pointer;
            transition: background 0.3s;
        }

        .user-badge:hover {
            background: rgba(255,255,255,0.3);
        }

        .lang-select {
            background: rgba(255,255,255,0.2);
            border: none;
            color: white;
            padding: 0.4rem 0.75rem;
            border-radius: 50px;
            font-size: 0.85rem;
            cursor: pointer;
        }

        .lang-select option {
            color: var(--dark);
        }

        .btn-logout {
            background: rgba(255,255,255,0.2);
            color: white;
            border: none;
            padding: 0.4rem 0.75rem;
            border-radius: 50px;
            font-size: 0.85rem;
            cursor: pointer;
            font-weight: 600;
            transition: background 0.3s;
        }

        .btn-logout:hover {
            background: rgba(255,255,255,0.3);
        }

        .btn-subscribe {
            background: var(--warning);
            color: var(--dark);
            border: none;
            padding: 0.4rem 0.75rem;
            border-radius: 50px;
            font-size: 0.85rem;
            cursor: pointer;
            font-weight: 700;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        /* Trial Banner */
        .trial-banner {
            background: linear-gradient(135deg, var(--warning), #D97706);
            color: white;
            text-align: center;
            padding: 0.75rem;
            font-weight: 600;
            font-size: 0.9rem;
        }

        .trial-banner.urgent {
            background: linear-gradient(135deg, var(--danger), #DC2626);
            animation: urgentPulse 1s infinite;
        }

        @keyframes urgentPulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.8; }
        }

        /* Eco Banner */
        .eco-banner {
            background: linear-gradient(135deg, var(--success), #059669);
            color: white;
            text-align: center;
            padding: 0.75rem;
            font-weight: 600;
            font-size: 0.9rem;
            display: flex;
            justify-content: center;
            gap: 2rem;
            flex-wrap: wrap;
        }

        /* Tab Navigation */
        .tab-nav {
            background: white;
            border-bottom: 2px solid var(--gray);
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
            scrollbar-width: none;
        }

        .tab-nav::-webkit-scrollbar {
            display: none;
        }

        .tab-nav-inner {
            display: flex;
            max-width: 1400px;
            margin: 0 auto;
            min-width: max-content;
        }

        .tab-btn {
            flex: 1;
            min-width: 100px;
            padding: 1rem 1.25rem;
            border: none;
            background: none;
            cursor: pointer;
            font-weight: 600;
            color: var(--gray-dark);
            transition: all 0.3s;
            white-space: nowrap;
            font-family: inherit;
            font-size: 0.9rem;
        }

        .tab-btn:hover {
            color: var(--primary);
            background: rgba(107, 70, 193, 0.05);
        }

        .tab-btn.active {
            color: white;
            background: var(--gradient-btn);
            border-radius: var(--radius-sm) var(--radius-sm) 0 0;
        }

        /* Content Container */
        .content-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 1.5rem;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Cards */
        .card {
            background: white;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            padding: 1.5rem;
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .card:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-lg);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .card-title {
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--dark);
        }

        /* Planner Cards Grid */
        .planner-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.25rem;
            margin-bottom: 2rem;
        }

        .planner-card {
            background: white;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            padding: 1.5rem;
            text-align: center;
            transition: all 0.3s;
            cursor: pointer;
            border: 3px solid transparent;
        }

        .planner-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }

        .planner-card.todo { border-color: var(--success); }
        .planner-card.projeto { border-color: var(--info); }
        .planner-card.habitos { border-color: var(--warning); }
        .planner-card.financeiro { border-color: var(--primary); }

        .planner-card .icon {
            font-size: 3rem;
            margin-bottom: 0.75rem;
        }

        .planner-card h3 {
            font-size: 1.1rem;
            margin-bottom: 0.5rem;
            color: var(--dark);
        }

        .planner-card p {
            font-size: 0.85rem;
            color: var(--gray-dark);
            margin-bottom: 1rem;
        }

        /* My Planners List */
        .section-title {
            font-size: 1.25rem;
            font-weight: 700;
            margin-bottom: 1rem;
            color: var(--dark);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .planners-list {
            display: grid;
            gap: 1rem;
        }

        .planner-item {
            background: white;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            padding: 1rem 1.25rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            transition: all 0.3s;
        }

        .planner-item:hover {
            transform: translateX(5px);
            box-shadow: var(--shadow-lg);
        }

        .planner-item-info {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .planner-item-icon {
            width: 45px;
            height: 45px;
            border-radius: var(--radius-sm);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
        }

        .planner-item-icon.todo { background: rgba(16, 185, 129, 0.1); }
        .planner-item-icon.projeto { background: rgba(59, 130, 246, 0.1); }
        .planner-item-icon.habitos { background: rgba(245, 158, 11, 0.1); }
        .planner-item-icon.financeiro { background: rgba(107, 70, 193, 0.1); }

        .planner-item-details h4 {
            font-size: 1rem;
            color: var(--dark);
        }

        .planner-item-details span {
            font-size: 0.85rem;
            color: var(--gray-dark);
        }

        .planner-item-actions {
            display: flex;
            gap: 0.5rem;
        }

        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1.25rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: white;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            padding: 1.25rem;
            text-align: center;
        }

        .stat-card .icon {
            font-size: 2rem;
            margin-bottom: 0.5rem;
        }

        .stat-card .value {
            font-size: 2rem;
            font-weight: 700;
            color: var(--primary);
        }

        .stat-card .label {
            font-size: 0.85rem;
            color: var(--gray-dark);
            margin-top: 0.25rem;
        }

        /* XP Bar */
        .xp-bar-container {
            background: var(--gray);
            border-radius: 50px;
            height: 12px;
            margin-top: 0.75rem;
            overflow: hidden;
        }

        .xp-bar {
            background: var(--gradient-btn);
            height: 100%;
            border-radius: 50px;
            transition: width 0.5s ease;
        }

        .xp-text {
            font-size: 0.75rem;
            color: var(--gray-dark);
            margin-top: 0.25rem;
        }

        /* Charts */
        .charts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
        }

        .chart-card {
            background: white;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            padding: 1.5rem;
        }

        .chart-card h3 {
            font-size: 1rem;
            margin-bottom: 1rem;
            color: var(--dark);
        }

        .chart-container {
            position: relative;
            height: 250px;
        }

        /* Achievements Grid */
        .achievements-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
            gap: 1rem;
        }

        .achievement-card {
            background: white;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            padding: 1.25rem;
            text-align: center;
            transition: all 0.3s;
        }

        .achievement-card.locked {
            opacity: 0.4;
            filter: grayscale(1);
        }

        .achievement-card.unlocked {
            border: 2px solid var(--success);
        }

        .achievement-card .icon {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
        }

        .achievement-card h4 {
            font-size: 0.9rem;
            margin-bottom: 0.25rem;
            color: var(--dark);
        }

        .achievement-card p {
            font-size: 0.75rem;
            color: var(--gray-dark);
        }

        /* Task Views */
        .view-toggle {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1rem;
            flex-wrap: wrap;
        }

        .view-btn {
            padding: 0.5rem 1rem;
            border: 2px solid var(--gray);
            background: white;
            border-radius: var(--radius-sm);
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
            font-family: inherit;
        }

        .view-btn.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        /* Task List */
        .task-list {
            display: grid;
            gap: 0.75rem;
        }

        .task-item {
            background: white;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            padding: 1rem 1.25rem;
            display: flex;
            align-items: flex-start;
            gap: 1rem;
            transition: all 0.3s;
        }

        .task-item:hover {
            box-shadow: var(--shadow-lg);
        }

        .task-item.done {
            opacity: 0.6;
        }

        .task-item.done .task-title {
            text-decoration: line-through;
        }

        .task-checkbox {
            width: 24px;
            height: 24px;
            border: 2px solid var(--gray);
            border-radius: 6px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            transition: all 0.3s;
        }

        .task-checkbox:hover {
            border-color: var(--primary);
        }

        .task-checkbox.checked {
            background: var(--success);
            border-color: var(--success);
            color: white;
        }

        .task-content {
            flex: 1;
        }

        .task-title {
            font-weight: 600;
            color: var(--dark);
            margin-bottom: 0.25rem;
        }

        .task-meta {
            display: flex;
            gap: 0.75rem;
            flex-wrap: wrap;
            font-size: 0.8rem;
            color: var(--gray-dark);
        }

        .task-meta span {
            display: inline-flex;
            align-items: center;
            gap: 0.25rem;
        }

        .priority-badge {
            display: inline-block;
            padding: 0.2rem 0.5rem;
            border-radius: 50px;
            font-size: 0.75rem;
            font-weight: 600;
        }

        .priority-baixa { background: rgba(16, 185, 129, 0.1); color: var(--success); }
        .priority-media { background: rgba(245, 158, 11, 0.1); color: var(--warning); }
        .priority-alta { background: rgba(239, 68, 68, 0.1); color: var(--danger); }
        .priority-urgente { background: rgba(239, 68, 68, 0.2); color: var(--danger); }
        .priority-critica { background: var(--danger); color: white; }

        .task-tags {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
            margin-top: 0.5rem;
        }

        .tag {
            background: rgba(107, 70, 193, 0.1);
            color: var(--primary);
            padding: 0.2rem 0.5rem;
            border-radius: 50px;
            font-size: 0.75rem;
            font-weight: 600;
        }

        .task-actions {
            display: flex;
            gap: 0.5rem;
        }

        /* Kanban Board */
        .kanban-board {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1rem;
            overflow-x: auto;
        }

        @media (max-width: 768px) {
            .kanban-board {
                grid-template-columns: 1fr;
            }
        }

        .kanban-column {
            background: var(--light);
            border-radius: var(--radius);
            padding: 1rem;
            min-height: 400px;
        }

        .kanban-column h3 {
            font-size: 1rem;
            margin-bottom: 1rem;
            padding-bottom: 0.75rem;
            border-bottom: 2px solid var(--gray);
        }

        .kanban-column.todo h3 { color: var(--gray-dark); }
        .kanban-column.progress h3 { color: var(--warning); }
        .kanban-column.done h3 { color: var(--success); }

        .kanban-tasks {
            display: grid;
            gap: 0.75rem;
        }

        .kanban-task {
            background: white;
            border-radius: var(--radius-sm);
            padding: 0.75rem;
            box-shadow: var(--shadow);
            cursor: grab;
        }

        .kanban-task:active {
            cursor: grabbing;
        }

        /* Calendar Grid */
        .calendar-container {
            background: white;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            padding: 1.5rem;
        }

        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .calendar-header h3 {
            font-size: 1.25rem;
        }

        .calendar-nav {
            display: flex;
            gap: 0.5rem;
        }

        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 0.5rem;
        }

        .calendar-day-header {
            text-align: center;
            font-weight: 600;
            color: var(--gray-dark);
            font-size: 0.85rem;
            padding: 0.5rem;
        }

        .calendar-day {
            aspect-ratio: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            border-radius: var(--radius-sm);
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.9rem;
            position: relative;
        }

        .calendar-day:hover {
            background: var(--gray);
        }

        .calendar-day.today {
            background: var(--gradient-btn);
            color: white;
            font-weight: 700;
        }

        .calendar-day.has-tasks::after {
            content: '';
            position: absolute;
            bottom: 4px;
            width: 6px;
            height: 6px;
            background: var(--primary);
            border-radius: 50%;
        }

        .calendar-day.other-month {
            opacity: 0.3;
        }

        /* Library Templates Grid */
        .library-section {
            margin-bottom: 2rem;
        }

        .library-section h3 {
            font-size: 1.1rem;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .templates-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
            gap: 1rem;
        }

        .template-card {
            background: white;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            padding: 1rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }

        .template-card:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-lg);
        }

        .template-card .icon {
            font-size: 2rem;
            margin-bottom: 0.5rem;
        }

        .template-card h4 {
            font-size: 0.85rem;
            color: var(--dark);
        }

        .template-card span {
            font-size: 0.75rem;
            color: var(--gray-dark);
        }

        /* Tutorials */
        .tutorials-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
        }

        .tutorial-card {
            background: white;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            overflow: hidden;
            transition: all 0.3s;
        }

        .tutorial-card:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-lg);
        }

        .tutorial-thumb {
            background: var(--gradient);
            height: 140px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3rem;
        }

        .tutorial-info {
            padding: 1.25rem;
        }

        .tutorial-info h4 {
            font-size: 1rem;
            margin-bottom: 0.5rem;
        }

        .tutorial-info p {
            font-size: 0.85rem;
            color: var(--gray-dark);
        }

        /* Google Calendar */
        .google-calendar-section {
            max-width: 600px;
            margin: 0 auto;
        }

        .calendar-url-box {
            background: var(--light);
            border: 2px dashed var(--gray);
            border-radius: var(--radius);
            padding: 1rem;
            margin: 1rem 0;
            word-break: break-all;
            font-family: monospace;
            font-size: 0.85rem;
        }

        .instructions-list {
            background: white;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            padding: 1.5rem;
            margin-top: 1.5rem;
        }

        .instructions-list h4 {
            margin-bottom: 1rem;
        }

        .instructions-list ol {
            padding-left: 1.5rem;
        }

        .instructions-list li {
            margin-bottom: 0.75rem;
            color: var(--dark);
        }

        /* Modals */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            padding: 1rem;
            overflow-y: auto;
        }

        .modal-overlay.active {
            display: flex;
        }

        .modal {
            background: white;
            border-radius: var(--radius-lg);
            width: 100%;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
            animation: modalSlideIn 0.3s ease;
        }

        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .modal-header {
            padding: 1.25rem 1.5rem;
            border-bottom: 1px solid var(--gray);
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            background: white;
            border-radius: var(--radius-lg) var(--radius-lg) 0 0;
        }

        .modal-header h2 {
            font-size: 1.25rem;
        }

        .modal-close {
            width: 36px;
            height: 36px;
            border: none;
            background: var(--gray);
            border-radius: 50%;
            cursor: pointer;
            font-size: 1.25rem;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
        }

        .modal-close:hover {
            background: var(--danger);
            color: white;
        }

        .modal-body {
            padding: 1.5rem;
        }

        .modal-footer {
            padding: 1rem 1.5rem;
            border-top: 1px solid var(--gray);
            display: flex;
            justify-content: flex-end;
            gap: 0.75rem;
        }

        /* Form Rows */
        .form-row {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
        }

        @media (max-width: 500px) {
            .form-row {
                grid-template-columns: 1fr;
            }
        }

        .form-row-3 {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1rem;
        }

        @media (max-width: 600px) {
            .form-row-3 {
                grid-template-columns: 1fr;
            }
        }

        /* Tags Input */
        .tags-container {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-top: 0.5rem;
        }

        .tag-input-wrapper {
            display: flex;
            gap: 0.5rem;
        }

        .tag-input-wrapper input {
            flex: 1;
        }

        /* Subtasks */
        .subtasks-list {
            margin-top: 0.5rem;
        }

        .subtask-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 0.5rem;
            padding: 0.5rem;
            background: var(--light);
            border-radius: var(--radius-sm);
        }

        .subtask-item input[type="checkbox"] {
            width: 18px;
            height: 18px;
        }

        .subtask-item span {
            flex: 1;
        }

        .subtask-item button {
            background: none;
            border: none;
            color: var(--danger);
            cursor: pointer;
            font-size: 1rem;
        }

        /* Level Up Modal */
        .level-up-modal {
            text-align: center;
            padding: 3rem 2rem;
        }

        .level-up-modal .icon {
            font-size: 5rem;
            animation: bounce 0.5s ease infinite alternate;
        }

        @keyframes bounce {
            from { transform: translateY(0); }
            to { transform: translateY(-10px); }
        }

        .level-up-modal h2 {
            font-size: 2.5rem;
            background: var(--gradient-btn);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin: 1rem 0;
        }

        .level-up-modal .level-display {
            font-size: 3rem;
            font-weight: 700;
            color: var(--primary);
        }

        /* Confetti */
        .confetti-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 3000;
            overflow: hidden;
        }

        .confetti {
            position: absolute;
            width: 10px;
            height: 10px;
            opacity: 0;
            animation: confettiFall 3s ease-out forwards;
        }

        @keyframes confettiFall {
            0% {
                opacity: 1;
                transform: translateY(-100px) rotate(0deg);
            }
            100% {
                opacity: 0;
                transform: translateY(100vh) rotate(720deg);
            }
        }

        /* Paywall */
        .paywall-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 5000;
        }

        .paywall-overlay.active {
            display: flex;
        }

        .paywall-modal {
            background: white;
            border-radius: var(--radius-lg);
            padding: 3rem 2rem;
            text-align: center;
            max-width: 400px;
            width: 90%;
        }

        .paywall-modal .icon {
            font-size: 4rem;
            margin-bottom: 1rem;
        }

        .paywall-modal h2 {
            font-size: 1.75rem;
            color: var(--dark);
            margin-bottom: 0.5rem;
        }

        .paywall-modal p {
            color: var(--gray-dark);
            margin-bottom: 1.5rem;
        }

        .price-box {
            background: var(--light);
            border-radius: var(--radius);
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .price-box .price {
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--primary);
        }

        .price-box .period {
            color: var(--gray-dark);
        }

        /* Install Banner */
        .install-banner {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: var(--gradient-btn);
            color: white;
            padding: 1rem 1.5rem;
            border-radius: var(--radius);
            box-shadow: var(--shadow-lg);
            display: none;
            align-items: center;
            gap: 1rem;
            z-index: 1500;
            animation: slideUp 0.5s ease;
        }

        .install-banner.active {
            display: flex;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(50px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .install-banner button {
            background: white;
            color: var(--primary);
            border: none;
            padding: 0.5rem 1rem;
            border-radius: var(--radius-sm);
            font-weight: 600;
            cursor: pointer;
        }

        .install-banner .close-install {
            background: none;
            color: white;
            font-size: 1.25rem;
            padding: 0;
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 3rem;
            color: var(--gray-dark);
        }

        .empty-state .icon {
            font-size: 4rem;
            margin-bottom: 1rem;
            opacity: 0.5;
        }

        .empty-state h3 {
            font-size: 1.25rem;
            margin-bottom: 0.5rem;
            color: var(--dark);
        }

        /* Filters */
        .filters-bar {
            display: flex;
            gap: 1rem;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
        }

        .filters-bar select, .filters-bar input {
            padding: 0.5rem 1rem;
            border: 2px solid var(--gray);
            border-radius: var(--radius-sm);
            font-family: inherit;
        }

        .filters-bar input {
            flex: 1;
            min-width: 200px;
        }

        /* Export Buttons */
        .export-buttons {
            display: flex;
            gap: 0.75rem;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .navbar-content {
                flex-direction: column;
                align-items: flex-start;
            }

            .navbar-user {
                width: 100%;
                justify-content: flex-start;
            }

            .content-container {
                padding: 1rem;
            }

            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .modal {
                max-height: 95vh;
            }
        }

        /* Print Styles */
        @media print {
            .navbar, .tab-nav, .trial-banner, .eco-banner, .install-banner {
                display: none !important;
            }

            .content-container {
                max-width: 100%;
                padding: 0;
            }

            .card, .task-item {
                box-shadow: none;
                border: 1px solid var(--gray);
            }
        }
    </style>
</head>
<body>
    <!-- Loading Screen -->
    <div id="loading-screen">
        <div class="loader"></div>
        <p id="loading-text">Inicializando sistema...</p>
    </div>

    <!-- Auth Screen -->
    <div id="auth-screen" style="display: none;">
        <div class="auth-container">
            <div class="auth-header">
                <h1>‚ú® Planner Premium ULTRA</h1>
                <p id="auth-subtitle">Organize sua vida com gamifica√ß√£o</p>
                <div class="trial-badge" id="trial-badge-auth">üéÅ 14 dias gr√°tis ‚Ä¢ R$ 19,99/m√™s</div>
            </div>
            <div class="auth-tabs">
                <button class="auth-tab active" data-tab="login" id="tab-login">Entrar</button>
                <button class="auth-tab" data-tab="signup" id="tab-signup">Criar Conta</button>
            </div>
            <form class="auth-form" id="auth-form">
                <div class="form-group" id="name-group" style="display: none;">
                    <label for="auth-name" id="label-name">Nome</label>
                    <input type="text" id="auth-name" placeholder="Seu nome">
                </div>
                <div class="form-group">
                    <label for="auth-email">Email</label>
                    <input type="email" id="auth-email" placeholder="seu@email.com" required>
                </div>
                <div class="form-group">
                    <label for="auth-password" id="label-password">Senha</label>
                    <input type="password" id="auth-password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required minlength="6">
                </div>
                <button type="submit" class="btn btn-primary" id="auth-submit-btn">
                    <span>Entrar</span>
                </button>
            </form>
        </div>
    </div>

    <!-- Main App -->
    <div id="main-app">
        <!-- Trial Banner -->
        <div class="trial-banner" id="trial-banner" style="display: none;">
            <span id="trial-text">‚è∞ Seu per√≠odo de teste termina em X dias</span>
        </div>

        <!-- Navbar -->
        <nav class="navbar">
            <div class="navbar-content">
                <div class="navbar-brand">‚ú® Planner Premium ULTRA</div>
                <div class="navbar-user">
                    <div class="user-badge" id="level-badge" onclick="switchTab('stats')">
                        <span>‚≠ê</span>
                        <span id="user-level">1</span>
                    </div>
                    <div class="user-badge" id="streak-badge">
                        <span>üî•</span>
                        <span id="user-streak">0</span>
                    </div>
                    <div class="user-badge" id="name-badge">
                        <span>üë§</span>
                        <span id="user-name">Usu√°rio</span>
                    </div>
                    <select class="lang-select" id="lang-select" onchange="changeLanguage(this.value)">
                        <option value="pt">üáßüá∑ PT</option>
                        <option value="en">üá∫üá∏ EN</option>
                        <option value="es">üá™üá∏ ES</option>
                        <option value="fr">üá´üá∑ FR</option>
                        <option value="de">üá©üá™ DE</option>
                    </select>
                    <button class="btn-subscribe" id="btn-subscribe" onclick="showPaywall()" style="display: none;">
                        Assinar
                    </button>
                    <button class="btn-logout" id="btn-logout" onclick="logout()">Sair</button>
                </div>
            </div>
        </nav>

        <!-- Eco Banner -->
        <div class="eco-banner">
            <span>üå± 100% Digital ‚Ä¢ Zero Papel</span>
            <span id="pages-saved">üìÑ 0 p√°ginas salvas</span>
            <span id="trees-saved">üå≥ 0 √°rvores salvas</span>
        </div>

        <!-- Tab Navigation -->
        <div class="tab-nav">
            <div class="tab-nav-inner">
                <button class="tab-btn active" data-tab="planners" onclick="switchTab('planners')">üìã Planners</button>
                <button class="tab-btn" data-tab="library" onclick="switchTab('library')">üìñ Biblioteca</button>
                <button class="tab-btn" data-tab="tutorials" onclick="switchTab('tutorials')">üéì Tutoriais</button>
                <button class="tab-btn" data-tab="stats" onclick="switchTab('stats')">üìä Stats</button>
                <button class="tab-btn" data-tab="achievements" onclick="switchTab('achievements')">üèÜ Conquistas</button>
                <button class="tab-btn" data-tab="calendar" onclick="switchTab('calendar')">üìÖ Calend√°rio</button>
                <button class="tab-btn" data-tab="google" onclick="switchTab('google')">üîó Google</button>
            </div>
        </div>

        <!-- Content Container -->
        <div class="content-container">
            <!-- Planners Tab -->
            <div class="tab-content active" id="tab-planners">
                <h2 class="section-title" id="title-create-planner">‚ú® Criar Novo Planner</h2>
                <div class="planner-grid">
                    <div class="planner-card todo" onclick="createPlanner('todo')">
                        <div class="icon">‚úÖ</div>
                        <h3>To-Do List</h3>
                        <p id="desc-todo">Gerenciamento simples de tarefas</p>
                        <button class="btn btn-success btn-sm" id="btn-create">Criar</button>
                    </div>
                    <div class="planner-card projeto" onclick="createPlanner('projeto')">
                        <div class="icon">üèóÔ∏è</div>
                        <h3 id="title-projects">Projetos</h3>
                        <p id="desc-projects">Acompanhamento de projetos multi-fase</p>
                        <button class="btn btn-sm" style="background: var(--info); color: white;">Criar</button>
                    </div>
                    <div class="planner-card habitos" onclick="createPlanner('habitos')">
                        <div class="icon">üî•</div>
                        <h3 id="title-habits">H√°bitos</h3>
                        <p id="desc-habits">Rastreador de h√°bitos di√°rios</p>
                        <button class="btn btn-sm" style="background: var(--warning); color: white;">Criar</button>
                    </div>
                    <div class="planner-card financeiro" onclick="createPlanner('financeiro')">
                        <div class="icon">üí∞</div>
                        <h3 id="title-financial">Financeiro</h3>
                        <p id="desc-financial">Controle de or√ßamento e despesas</p>
                        <button class="btn btn-sm" style="background: var(--primary); color: white;">Criar</button>
                    </div>
                </div>

                <h2 class="section-title" id="title-my-planners">üìÅ Meus Planners</h2>
                <div class="planners-list" id="planners-list">
                    <div class="empty-state" id="empty-planners">
                        <div class="icon">üìã</div>
                        <h3 id="empty-title">Nenhum planner ainda</h3>
                        <p id="empty-desc">Crie seu primeiro planner acima!</p>
                    </div>
                </div>
            </div>

            <!-- Library Tab -->
            <div class="tab-content" id="tab-library">
                <h2 class="section-title">üìñ Biblioteca de Templates (900+ p√°ginas)</h2>
                
                <div class="library-section">
                    <h3>üìÖ Planejamento Temporal</h3>
                    <div class="templates-grid">
                        <div class="template-card" onclick="openTemplate('daily')">
                            <div class="icon">üìÖ</div>
                            <h4>P√°ginas Di√°rias</h4>
                            <span>365 templates</span>
                        </div>
                        <div class="template-card" onclick="openTemplate('weekly')">
                            <div class="icon">üìÜ</div>
                            <h4>P√°ginas Semanais</h4>
                            <span>52 templates</span>
                        </div>
                        <div class="template-card" onclick="openTemplate('monthly')">
                            <div class="icon">üóìÔ∏è</div>
                            <h4>P√°ginas Mensais</h4>
                            <span>12 templates</span>
                        </div>
                        <div class="template-card" onclick="openTemplate('annual')">
                            <div class="icon">üìä</div>
                            <h4>Vis√£o Anual</h4>
                            <span>1 template</span>
                        </div>
                    </div>
                </div>

                <div class="library-section">
                    <h3>üéØ Planners Tem√°ticos</h3>
                    <div class="templates-grid">
                        <div class="template-card" onclick="openTemplate('financial')">
                            <div class="icon">üí∞</div>
                            <h4>Controle Financeiro</h4>
                            <span>50 templates</span>
                        </div>
                        <div class="template-card" onclick="openTemplate('health')">
                            <div class="icon">üí™</div>
                            <h4>Sa√∫de & Bem-estar</h4>
                            <span>45 templates</span>
                        </div>
                        <div class="template-card" onclick="openTemplate('reading')">
                            <div class="icon">üìö</div>
                            <h4>Registro de Leitura</h4>
                            <span>30 templates</span>
                        </div>
                        <div class="template-card" onclick="openTemplate('travel')">
                            <div class="icon">‚úàÔ∏è</div>
                            <h4>Planejador de Viagem</h4>
                            <span>40 templates</span>
                        </div>
                        <div class="template-card" onclick="openTemplate('goals')">
                            <div class="icon">üéØ</div>
                            <h4>Defini√ß√£o de Metas</h4>
                            <span>35 templates</span>
                        </div>
                        <div class="template-card" onclick="openTemplate('habits')">
                            <div class="icon">üî•</div>
                            <h4>Tracker de H√°bitos</h4>
                            <span>60 templates</span>
                        </div>
                        <div class="template-card" onclick="openTemplate('meal')">
                            <div class="icon">üçΩÔ∏è</div>
                            <h4>Planejador de Refei√ß√µes</h4>
                            <span>52 templates</span>
                        </div>
                        <div class="template-card" onclick="openTemplate('workout')">
                            <div class="icon">üèãÔ∏è</div>
                            <h4>Plano de Treino</h4>
                            <span>48 templates</span>
                        </div>
                        <div class="template-card" onclick="openTemplate('study')">
                            <div class="icon">üìù</div>
                            <h4>Plano de Estudos</h4>
                            <span>55 templates</span>
                        </div>
                        <div class="template-card" onclick="openTemplate('gratitude')">
                            <div class="icon">üôè</div>
                            <h4>Di√°rio de Gratid√£o</h4>
                            <span>365 templates</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Tutorials Tab -->
            <div class="tab-content" id="tab-tutorials">
                <h2 class="section-title">üéì Tutoriais e Guias</h2>
                <div class="tutorials-grid">
                    <div class="tutorial-card" onclick="openTutorial('getting-started')">
                        <div class="tutorial-thumb">üöÄ</div>
                        <div class="tutorial-info">
                            <h4>Come√ßando</h4>
                            <p>Aprenda o b√°sico do Planner Premium ULTRA</p>
                        </div>
                    </div>
                    <div class="tutorial-card" onclick="openTutorial('gamification')">
                        <div class="tutorial-thumb">üéÆ</div>
                        <div class="tutorial-info">
                            <h4>Sistema de Gamifica√ß√£o</h4>
                            <p>Entenda XP, n√≠veis, streaks e conquistas</p>
                        </div>
                    </div>
                    <div class="tutorial-card" onclick="openTutorial('advanced-tasks')">
                        <div class="tutorial-thumb">‚ö°</div>
                        <div class="tutorial-info">
                            <h4>Tarefas Avan√ßadas</h4>
                            <p>Subtarefas, lembretes e tags</p>
                        </div>
                    </div>
                    <div class="tutorial-card" onclick="openTutorial('productivity')">
                        <div class="tutorial-thumb">üìà</div>
                        <div class="tutorial-info">
                            <h4>Dicas de Produtividade</h4>
                            <p>Maximize sua efici√™ncia</p>
                        </div>
                    </div>
                    <div class="tutorial-card" onclick="openTutorial('calendar-sync')">
                        <div class="tutorial-thumb">üîó</div>
                        <div class="tutorial-info">
                            <h4>Sincroniza√ß√£o com Google Calendar</h4>
                            <p>Conecte seus calend√°rios</p>
                        </div>
                    </div>
                    <div class="tutorial-card" onclick="openTutorial('templates')">
                        <div class="tutorial-thumb">üìã</div>
                        <div class="tutorial-info">
                            <h4>Usando Templates</h4>
                            <p>Aproveite ao m√°ximo a biblioteca</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Stats Tab -->
            <div class="tab-content" id="tab-stats">
                <h2 class="section-title">üìä Suas Estat√≠sticas</h2>
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="icon">‚≠ê</div>
                        <div class="value" id="stat-level">1</div>
                        <div class="label" id="label-level">N√≠vel</div>
                        <div class="xp-bar-container">
                            <div class="xp-bar" id="xp-bar" style="width: 0%"></div>
                        </div>
                        <div class="xp-text" id="xp-text">0 / 100 XP</div>
                    </div>
                    <div class="stat-card">
                        <div class="icon">üî•</div>
                        <div class="value" id="stat-streak">0</div>
                        <div class="label" id="label-streak">Dias de Streak</div>
                    </div>
                    <div class="stat-card">
                        <div class="icon">‚úÖ</div>
                        <div class="value" id="stat-completed">0</div>
                        <div class="label" id="label-completed">Tarefas Conclu√≠das</div>
                    </div>
                    <div class="stat-card">
                        <div class="icon">üìà</div>
                        <div class="value" id="stat-rate">0%</div>
                        <div class="label" id="label-rate">Taxa de Conclus√£o</div>
                    </div>
                </div>

                <div class="charts-grid">
                    <div class="chart-card">
                        <h3>üìä Produtividade Semanal</h3>
                        <div class="chart-container">
                            <canvas id="weekly-chart"></canvas>
                        </div>
                    </div>
                    <div class="chart-card">
                        <h3>üéØ Tarefas por Prioridade</h3>
                        <div class="chart-container">
                            <canvas id="priority-chart"></canvas>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Achievements Tab -->
            <div class="tab-content" id="tab-achievements">
                <h2 class="section-title">üèÜ Conquistas</h2>
                <div class="achievements-grid" id="achievements-grid">
                    <div class="achievement-card locked" id="ach-first-task">
                        <div class="icon">üéØ</div>
                        <h4>Primeira Tarefa</h4>
                        <p>Complete 1 tarefa</p>
                    </div>
                    <div class="achievement-card locked" id="ach-task-master">
                        <div class="icon">üëë</div>
                        <h4>Mestre das Tarefas</h4>
                        <p>Complete 10 tarefas</p>
                    </div>
                    <div class="achievement-card locked" id="ach-centenarian">
                        <div class="icon">üíØ</div>
                        <h4>Centen√°rio</h4>
                        <p>Complete 100 tarefas</p>
                    </div>
                    <div class="achievement-card locked" id="ach-week-streak">
                        <div class="icon">üî•</div>
                        <h4>Streak 7 Dias</h4>
                        <p>Mantenha 7 dias de streak</p>
                    </div>
                    <div class="achievement-card locked" id="ach-month-streak">
                        <div class="icon">üí™</div>
                        <h4>Streak 30 Dias</h4>
                        <p>Mantenha 30 dias de streak</p>
                    </div>
                    <div class="achievement-card locked" id="ach-level-10">
                        <div class="icon">‚≠ê</div>
                        <h4>N√≠vel 10</h4>
                        <p>Alcance o n√≠vel 10</p>
                    </div>
                    <div class="achievement-card locked" id="ach-planner-pro">
                        <div class="icon">üìã</div>
                        <h4>Planejador Pro</h4>
                        <p>Crie 5 planners</p>
                    </div>
                </div>
            </div>

            <!-- Calendar Tab -->
            <div class="tab-content" id="tab-calendar">
                <div class="calendar-container">
                    <div class="calendar-header">
                        <button class="btn btn-sm btn-secondary" onclick="changeMonth(-1)">‚óÄ</button>
                        <h3 id="calendar-month-year">Janeiro 2025</h3>
                        <button class="btn btn-sm btn-secondary" onclick="changeMonth(1)">‚ñ∂</button>
                    </div>
                    <div class="calendar-grid" id="calendar-grid">
                        <!-- Calendar days will be generated here -->
                    </div>
                </div>

                <div class="card" style="margin-top: 1.5rem;">
                    <h3 class="card-title" id="selected-date-title">Tarefas do Dia</h3>
                    <div id="day-tasks-list">
                        <div class="empty-state">
                            <p>Selecione um dia para ver as tarefas</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Google Calendar Tab -->
            <div class="tab-content" id="tab-google">
                <div class="google-calendar-section">
                    <div class="card">
                        <h3 class="card-title">üîó Sincronizar com Google Calendar</h3>
                        <p style="margin-bottom: 1rem; color: var(--gray-dark);">
                            Copie o link abaixo e adicione como uma URL de calend√°rio no Google Calendar.
                        </p>
                        
                        <div class="calendar-url-box" id="calendar-url">
                            webcal://planner-ultra.vercel.app/api/calendar/user-id.ics
                        </div>
                        
                        <button class="btn btn-primary" onclick="copyCalendarUrl()">
                            üìã Copiar Link
                        </button>
                    </div>

                    <div class="instructions-list">
                        <h4>üì± Como adicionar no celular:</h4>
                        <ol>
                            <li><strong>iOS:</strong> V√° em Ajustes ‚Üí Calend√°rio ‚Üí Contas ‚Üí Adicionar Conta ‚Üí Outro ‚Üí Adicionar Calend√°rio Assinado</li>
                            <li><strong>Android:</strong> Abra o Google Calendar ‚Üí Menu ‚Üí Configura√ß√µes ‚Üí Adicionar calend√°rio ‚Üí Por URL</li>
                        </ol>
                        
                        <h4 style="margin-top: 1.5rem;">üíª Como adicionar no computador:</h4>
                        <ol>
                            <li>Acesse calendar.google.com</li>
                            <li>Clique em "+" ao lado de "Outros calend√°rios"</li>
                            <li>Selecione "De URL"</li>
                            <li>Cole o link copiado</li>
                            <li>Clique em "Adicionar calend√°rio"</li>
                        </ol>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Planner Modal -->
    <div class="modal-overlay" id="planner-modal">
        <div class="modal" style="max-width: 900px;">
            <div class="modal-header">
                <h2 id="planner-modal-title">üìã Meu Planner</h2>
                <button class="modal-close" onclick="closePlannerModal()">√ó</button>
            </div>
            <div class="modal-body">
                <!-- View Toggle -->
                <div class="view-toggle">
                    <button class="view-btn active" onclick="setView('list')">üìã Lista</button>
                    <button class="view-btn" onclick="setView('kanban')">üìä Kanban</button>
                    <button class="view-btn" onclick="setView('timeline')">üìÖ Timeline</button>
                </div>

                <!-- Filters -->
                <div class="filters-bar">
                    <input type="text" placeholder="üîç Buscar tarefas..." id="task-search" oninput="filterTasks()">
                    <select id="filter-priority" onchange="filterTasks()">
                        <option value="">Todas Prioridades</option>
                        <option value="baixa">üü¢ Baixa</option>
                        <option value="media">üü° M√©dia</option>
                        <option value="alta">üî¥ Alta</option>
                        <option value="urgente">üî• Urgente</option>
                        <option value="critica">‚ö° Cr√≠tica</option>
                    </select>
                    <select id="filter-category" onchange="filterTasks()">
                        <option value="">Todas Categorias</option>
                        <option value="trabalho">üíº Trabalho</option>
                        <option value="pessoal">üè† Pessoal</option>
                        <option value="saude">üí™ Sa√∫de</option>
                        <option value="estudos">üìö Estudos</option>
                        <option value="financas">üí∞ Finan√ßas</option>
                        <option value="outro">üì¶ Outro</option>
                    </select>
                </div>

                <!-- Export Buttons -->
                <div class="export-buttons">
                    <button class="btn btn-sm btn-secondary" onclick="exportCSV()">üìä Exportar CSV</button>
                    <button class="btn btn-sm btn-secondary" onclick="exportPDF()">üìÑ Exportar PDF</button>
                </div>

                <!-- Add Task Button -->
                <button class="btn btn-primary" onclick="openTaskModal()" style="margin-bottom: 1rem;">
                    ‚ûï Nova Tarefa
                </button>

                <!-- List View -->
                <div id="view-list" class="task-view">
                    <div class="task-list" id="task-list">
                        <!-- Tasks will be rendered here -->
                    </div>
                </div>

                <!-- Kanban View -->
                <div id="view-kanban" class="task-view" style="display: none;">
                    <div class="kanban-board">
                        <div class="kanban-column todo">
                            <h3>üìã A Fazer</h3>
                            <div class="kanban-tasks" id="kanban-todo"></div>
                        </div>
                        <div class="kanban-column progress">
                            <h3>üîÑ Em Progresso</h3>
                            <div class="kanban-tasks" id="kanban-progress"></div>
                        </div>
                        <div class="kanban-column done">
                            <h3>‚úÖ Conclu√≠do</h3>
                            <div class="kanban-tasks" id="kanban-done"></div>
                        </div>
                    </div>
                </div>

                <!-- Timeline View -->
                <div id="view-timeline" class="task-view" style="display: none;">
                    <div class="task-list" id="timeline-list">
                        <!-- Timeline tasks will be rendered here -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Task Modal -->
    <div class="modal-overlay" id="task-modal">
        <div class="modal">
            <div class="modal-header">
                <h2 id="task-modal-title">‚ûï Nova Tarefa</h2>
                <button class="modal-close" onclick="closeTaskModal()">√ó</button>
            </div>
            <div class="modal-body">
                <form id="task-form">
                    <div class="form-group">
                        <label for="task-title">T√≠tulo *</label>
                        <input type="text" id="task-title" required placeholder="Digite o t√≠tulo da tarefa">
                    </div>

                    <div class="form-group">
                        <label for="task-desc">Descri√ß√£o</label>
                        <textarea id="task-desc" rows="3" placeholder="Adicione detalhes..."></textarea>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="task-category">Categoria</label>
                            <select id="task-category">
                                <option value="trabalho">üíº Trabalho</option>
                                <option value="pessoal">üè† Pessoal</option>
                                <option value="saude">üí™ Sa√∫de</option>
                                <option value="estudos">üìö Estudos</option>
                                <option value="financas">üí∞ Finan√ßas</option>
                                <option value="outro">üì¶ Outro</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="task-priority">Prioridade</label>
                            <select id="task-priority">
                                <option value="baixa">üü¢ Baixa</option>
                                <option value="media">üü° M√©dia</option>
                                <option value="alta">üî¥ Alta</option>
                                <option value="urgente">üî• Urgente</option>
                                <option value="critica">‚ö° Cr√≠tica</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-row-3">
                        <div class="form-group">
                            <label for="task-date">Data</label>
                            <input type="date" id="task-date">
                        </div>
                        <div class="form-group">
                            <label for="task-time">Hora</label>
                            <input type="time" id="task-time">
                        </div>
                        <div class="form-group">
                            <label for="task-duration">Dura√ß√£o (min)</label>
                            <input type="number" id="task-duration" min="0" placeholder="30">
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="task-repeat">Repetir</label>
                            <select id="task-repeat">
                                <option value="none">N√£o repetir</option>
                                <option value="daily">Diariamente</option>
                                <option value="weekly">Semanalmente</option>
                                <option value="monthly">Mensalmente</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="task-context">Contexto</label>
                            <select id="task-context">
                                <option value="anywhere">üìç Qualquer lugar</option>
                                <option value="home">üè† Casa</option>
                                <option value="office">üè¢ Escrit√≥rio</option>
                                <option value="online">üåê Online</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="task-energy">Energia Necess√°ria</label>
                        <select id="task-energy">
                            <option value="low">üòä Baixa</option>
                            <option value="medium">‚ö° M√©dia</option>
                            <option value="high">üî• Alta</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>Tags</label>
                        <div class="tag-input-wrapper">
                            <input type="text" id="tag-input" placeholder="Digite uma tag">
                            <button type="button" class="btn btn-sm btn-secondary" onclick="addTag()">+</button>
                        </div>
                        <div class="tags-container" id="tags-container"></div>
                    </div>

                    <div class="form-group">
                        <label>Subtarefas</label>
                        <div class="tag-input-wrapper">
                            <input type="text" id="subtask-input" placeholder="Digite uma subtarefa">
                            <button type="button" class="btn btn-sm btn-secondary" onclick="addSubtask()">+</button>
                        </div>
                        <div class="subtasks-list" id="subtasks-list"></div>
                    </div>

                    <div class="form-group">
                        <label for="task-reminder">Lembrete</label>
                        <select id="task-reminder">
                            <option value="none">Sem lembrete</option>
                            <option value="5">5 minutos antes</option>
                            <option value="15">15 minutos antes</option>
                            <option value="30">30 minutos antes</option>
                            <option value="60">1 hora antes</option>
                            <option value="1440">1 dia antes</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="task-link">Link/Anexo</label>
                        <input type="url" id="task-link" placeholder="https://...">
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeTaskModal()">Cancelar</button>
                <button class="btn btn-primary" onclick="saveTask()">üíæ Salvar Tarefa</button>
            </div>
        </div>
    </div>

    <!-- Level Up Modal -->
    <div class="modal-overlay" id="level-up-modal">
        <div class="modal" style="max-width: 400px;">
            <div class="level-up-modal">
                <div class="icon">üéâ</div>
                <h2>Level Up!</h2>
                <div class="level-display" id="new-level">N√≠vel 2</div>
                <button class="btn btn-primary" onclick="closeLevelUpModal()" style="margin-top: 1.5rem;">
                    Continuar
                </button>
            </div>
        </div>
    </div>

    <!-- Paywall Modal -->
    <div class="paywall-overlay" id="paywall-modal">
        <div class="paywall-modal">
            <div class="icon">üîí</div>
            <h2>Trial Expirado</h2>
            <p>Continue aproveitando todos os recursos premium!</p>
            <div class="price-box">
                <div class="price">R$ 19,99</div>
                <div class="period">por m√™s</div>
            </div>
            <button class="btn btn-primary" onclick="subscribe()">
                üí≥ Assinar Agora
            </button>
        </div>
    </div>

    <!-- Confetti Container -->
    <div class="confetti-container" id="confetti-container"></div>

    <!-- Install Banner -->
    <div class="install-banner" id="install-banner">
        <span>üì≤ Instale o app!</span>
        <button onclick="installPWA()">Instalar</button>
        <button class="close-install" onclick="closeInstallBanner()">√ó</button>
    </div>

    <script>
        // ==========================================
        // CONFIGURATION
        // ==========================================
        
        // Supabase Configuration - Replace with your own credentials
        const SUPABASE_URL = 'https://your-project.supabase.co';
        const SUPABASE_ANON_KEY = 'your-anon-key';
        
        // Demo mode (when Supabase is not configured)
        const DEMO_MODE = SUPABASE_URL === 'https://your-project.supabase.co';
        
        // Initialize Supabase
        let supabase = null;
        if (!DEMO_MODE && typeof window.supabase !== 'undefined') {
            supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
        }

        // ==========================================
        // STATE MANAGEMENT
        // ==========================================
        
        let currentUser = null;
        let currentPlanner = null;
        let tasks = [];
        let planners = [];
        let currentView = 'list';
        let currentLang = localStorage.getItem('planner_ultra_lang') || 'pt';
        let currentMonth = new Date().getMonth();
        let currentYear = new Date().getFullYear();
        let editingTaskId = null;
        let currentTags = [];
        let currentSubtasks = [];
        let deferredPrompt = null;
        let weeklyChart = null;
        let priorityChart = null;

        // ==========================================
        // INTERNATIONALIZATION
        // ==========================================
        
        const i18n = {
            pt: {
                appName: '‚ú® Planner Premium ULTRA',
                subtitle: 'Organize sua vida com gamifica√ß√£o',
                trialBadge: 'üéÅ 14 dias gr√°tis ‚Ä¢ R$ 19,99/m√™s',
                login: 'Entrar',
                signup: 'Criar Conta',
                name: 'Nome',
                email: 'Email',
                password: 'Senha',
                startTrial: 'Come√ßar Trial Gr√°tis',
                logout: 'Sair',
                subscribe: 'Assinar',
                level: 'N√≠vel',
                streak: 'Dias de Streak',
                completed: 'Tarefas Conclu√≠das',
                completionRate: 'Taxa de Conclus√£o',
                createPlanner: '‚ú® Criar Novo Planner',
                myPlanners: 'üìÅ Meus Planners',
                todoDesc: 'Gerenciamento simples de tarefas',
                projectsTitle: 'Projetos',
                projectsDesc: 'Acompanhamento de projetos multi-fase',
                habitsTitle: 'H√°bitos',
                habitsDesc: 'Rastreador de h√°bitos di√°rios',
                financialTitle: 'Financeiro',
                financialDesc: 'Controle de or√ßamento e despesas',
                emptyPlanners: 'Nenhum planner ainda',
                emptyPlannersDesc: 'Crie seu primeiro planner acima!',
                trialEnds: '‚è∞ Seu per√≠odo de teste termina em {days} dias',
                trialExpired: 'Trial Expirado',
                pagesSaved: 'üìÑ {count} p√°ginas salvas',
                treesSaved: 'üå≥ {count} √°rvores salvas',
                newTask: '‚ûï Nova Tarefa',
                saveTask: 'üíæ Salvar Tarefa',
                cancel: 'Cancelar',
                title: 'T√≠tulo',
                description: 'Descri√ß√£o',
                category: 'Categoria',
                priority: 'Prioridade',
                date: 'Data',
                time: 'Hora',
                duration: 'Dura√ß√£o (min)',
                repeat: 'Repetir',
                context: 'Contexto',
                energy: 'Energia Necess√°ria',
                tags: 'Tags',
                subtasks: 'Subtarefas',
                reminder: 'Lembrete',
                link: 'Link/Anexo',
                work: 'üíº Trabalho',
                personal: 'üè† Pessoal',
                health: 'üí™ Sa√∫de',
                studies: 'üìö Estudos',
                finance: 'üí∞ Finan√ßas',
                other: 'üì¶ Outro',
                low: 'üü¢ Baixa',
                medium: 'üü° M√©dia',
                high: 'üî¥ Alta',
                urgent: 'üî• Urgente',
                critical: '‚ö° Cr√≠tica',
                noRepeat: 'N√£o repetir',
                daily: 'Diariamente',
                weekly: 'Semanalmente',
                monthly: 'Mensalmente',
                anywhere: 'üìç Qualquer lugar',
                home: 'üè† Casa',
                office: 'üè¢ Escrit√≥rio',
                online: 'üåê Online',
                lowEnergy: 'üòä Baixa',
                mediumEnergy: '‚ö° M√©dia',
                highEnergy: 'üî• Alta',
                noReminder: 'Sem lembrete',
                mins5: '5 minutos antes',
                mins15: '15 minutos antes',
                mins30: '30 minutos antes',
                hour1: '1 hora antes',
                day1: '1 dia antes',
                levelUp: 'Level Up!',
                continue: 'Continuar',
                subscribeNow: 'üí≥ Assinar Agora',
                install: 'Instalar',
                installApp: 'üì≤ Instale o app!',
                copyLink: 'üìã Copiar Link',
                exportCSV: 'üìä Exportar CSV',
                exportPDF: 'üìÑ Exportar PDF',
                list: 'üìã Lista',
                kanban: 'üìä Kanban',
                timeline: 'üìÖ Timeline',
                todo: 'üìã A Fazer',
                inProgress: 'üîÑ Em Progresso',
                done: '‚úÖ Conclu√≠do',
                search: 'üîç Buscar tarefas...',
                allPriorities: 'Todas Prioridades',
                allCategories: 'Todas Categorias',
                weekdays: ['Dom', 'Seg', 'Ter', 'Qua', 'Qui', 'Sex', 'S√°b'],
                months: ['Janeiro', 'Fevereiro', 'Mar√ßo', 'Abril', 'Maio', 'Junho', 'Julho', 'Agosto', 'Setembro', 'Outubro', 'Novembro', 'Dezembro'],
                achievements: {
                    firstTask: 'Primeira Tarefa',
                    taskMaster: 'Mestre das Tarefas',
                    centenarian: 'Centen√°rio',
                    weekStreak: 'Streak 7 Dias',
                    monthStreak: 'Streak 30 Dias',
                    level10: 'N√≠vel 10',
                    plannerPro: 'Planejador Pro'
                }
            },
            en: {
                appName: '‚ú® Planner Premium ULTRA',
                subtitle: 'Organize your life with gamification',
                trialBadge: 'üéÅ 14 days free ‚Ä¢ $3.99/month',
                login: 'Login',
                signup: 'Sign Up',
                name: 'Name',
                email: 'Email',
                password: 'Password',
                startTrial: 'Start Free Trial',
                logout: 'Logout',
                subscribe: 'Subscribe',
                level: 'Level',
                streak: 'Streak Days',
                completed: 'Tasks Completed',
                completionRate: 'Completion Rate',
                createPlanner: '‚ú® Create New Planner',
                myPlanners: 'üìÅ My Planners',
                todoDesc: 'Simple task management',
                projectsTitle: 'Projects',
                projectsDesc: 'Multi-phase project tracking',
                habitsTitle: 'Habits',
                habitsDesc: 'Daily habit tracker',
                financialTitle: 'Financial',
                financialDesc: 'Budget and expense control',
                emptyPlanners: 'No planners yet',
                emptyPlannersDesc: 'Create your first planner above!',
                trialEnds: '‚è∞ Your trial ends in {days} days',
                trialExpired: 'Trial Expired',
                pagesSaved: 'üìÑ {count} pages saved',
                treesSaved: 'üå≥ {count} trees saved',
                newTask: '‚ûï New Task',
                saveTask: 'üíæ Save Task',
                cancel: 'Cancel',
                title: 'Title',
                description: 'Description',
                category: 'Category',
                priority: 'Priority',
                date: 'Date',
                time: 'Time',
                duration: 'Duration (min)',
                repeat: 'Repeat',
                context: 'Context',
                energy: 'Energy Required',
                tags: 'Tags',
                subtasks: 'Subtasks',
                reminder: 'Reminder',
                link: 'Link/Attachment',
                work: 'üíº Work',
                personal: 'üè† Personal',
                health: 'üí™ Health',
                studies: 'üìö Studies',
                finance: 'üí∞ Finance',
                other: 'üì¶ Other',
                low: 'üü¢ Low',
                medium: 'üü° Medium',
                high: 'üî¥ High',
                urgent: 'üî• Urgent',
                critical: '‚ö° Critical',
                noRepeat: 'No repeat',
                daily: 'Daily',
                weekly: 'Weekly',
                monthly: 'Monthly',
                anywhere: 'üìç Anywhere',
                home: 'üè† Home',
                office: 'üè¢ Office',
                online: 'üåê Online',
                lowEnergy: 'üòä Low',
                mediumEnergy: '‚ö° Medium',
                highEnergy: 'üî• High',
                noReminder: 'No reminder',
                mins5: '5 minutes before',
                mins15: '15 minutes before',
                mins30: '30 minutes before',
                hour1: '1 hour before',
                day1: '1 day before',
                levelUp: 'Level Up!',
                continue: 'Continue',
                subscribeNow: 'üí≥ Subscribe Now',
                install: 'Install',
                installApp: 'üì≤ Install the app!',
                copyLink: 'üìã Copy Link',
                exportCSV: 'üìä Export CSV',
                exportPDF: 'üìÑ Export PDF',
                list: 'üìã List',
                kanban: 'üìä Kanban',
                timeline: 'üìÖ Timeline',
                todo: 'üìã To Do',
                inProgress: 'üîÑ In Progress',
                done: '‚úÖ Done',
                search: 'üîç Search tasks...',
                allPriorities: 'All Priorities',
                allCategories: 'All Categories',
                weekdays: ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'],
                months: ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'],
                achievements: {
                    firstTask: 'First Task',
                    taskMaster: 'Task Master',
                    centenarian: 'Centenarian',
                    weekStreak: '7 Day Streak',
                    monthStreak: '30 Day Streak',
                    level10: 'Level 10',
                    plannerPro: 'Planner Pro'
                }
            },
            es: {
                appName: '‚ú® Planner Premium ULTRA',
                subtitle: 'Organiza tu vida con gamificaci√≥n',
                trialBadge: 'üéÅ 14 d√≠as gratis ‚Ä¢ $3.99/mes',
                login: 'Iniciar Sesi√≥n',
                signup: 'Crear Cuenta',
                name: 'Nombre',
                email: 'Correo',
                password: 'Contrase√±a',
                startTrial: 'Comenzar Prueba Gratis',
                logout: 'Salir',
                subscribe: 'Suscribirse',
                level: 'Nivel',
                streak: 'D√≠as de Racha',
                completed: 'Tareas Completadas',
                completionRate: 'Tasa de Conclusi√≥n',
                createPlanner: '‚ú® Crear Nuevo Planner',
                myPlanners: 'üìÅ Mis Planners',
                todoDesc: 'Gesti√≥n simple de tareas',
                projectsTitle: 'Proyectos',
                projectsDesc: 'Seguimiento de proyectos multi-fase',
                habitsTitle: 'H√°bitos',
                habitsDesc: 'Rastreador de h√°bitos diarios',
                financialTitle: 'Financiero',
                financialDesc: 'Control de presupuesto y gastos',
                emptyPlanners: 'Sin planners todav√≠a',
                emptyPlannersDesc: '¬°Crea tu primer planner arriba!',
                trialEnds: '‚è∞ Tu prueba termina en {days} d√≠as',
                trialExpired: 'Prueba Expirada',
                pagesSaved: 'üìÑ {count} p√°ginas guardadas',
                treesSaved: 'üå≥ {count} √°rboles salvados',
                weekdays: ['Dom', 'Lun', 'Mar', 'Mi√©', 'Jue', 'Vie', 'S√°b'],
                months: ['Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo', 'Junio', 'Julio', 'Agosto', 'Septiembre', 'Octubre', 'Noviembre', 'Diciembre']
            },
            fr: {
                appName: '‚ú® Planner Premium ULTRA',
                subtitle: 'Organisez votre vie avec la gamification',
                trialBadge: 'üéÅ 14 jours gratuits ‚Ä¢ 3,99‚Ç¨/mois',
                login: 'Connexion',
                signup: 'Cr√©er un Compte',
                name: 'Nom',
                email: 'Email',
                password: 'Mot de passe',
                startTrial: 'Commencer l\'Essai Gratuit',
                logout: 'D√©connexion',
                subscribe: 'S\'abonner',
                level: 'Niveau',
                streak: 'Jours de S√©rie',
                completed: 'T√¢ches Termin√©es',
                completionRate: 'Taux de Compl√©tion',
                weekdays: ['Dim', 'Lun', 'Mar', 'Mer', 'Jeu', 'Ven', 'Sam'],
                months: ['Janvier', 'F√©vrier', 'Mars', 'Avril', 'Mai', 'Juin', 'Juillet', 'Ao√ªt', 'Septembre', 'Octobre', 'Novembre', 'D√©cembre']
            },
            de: {
                appName: '‚ú® Planner Premium ULTRA',
                subtitle: 'Organisiere dein Leben mit Gamification',
                trialBadge: 'üéÅ 14 Tage kostenlos ‚Ä¢ 3,99‚Ç¨/Monat',
                login: 'Anmelden',
                signup: 'Konto Erstellen',
                name: 'Name',
                email: 'E-Mail',
                password: 'Passwort',
                startTrial: 'Kostenlose Testversion Starten',
                logout: 'Abmelden',
                subscribe: 'Abonnieren',
                level: 'Stufe',
                streak: 'Streak-Tage',
                completed: 'Erledigte Aufgaben',
                completionRate: 'Abschlussrate',
                weekdays: ['So', 'Mo', 'Di', 'Mi', 'Do', 'Fr', 'Sa'],
                months: ['Januar', 'Februar', 'M√§rz', 'April', 'Mai', 'Juni', 'Juli', 'August', 'September', 'Oktober', 'November', 'Dezember']
            }
        };

        function t(key) {
            const keys = key.split('.');
            let value = i18n[currentLang];
            for (const k of keys) {
                value = value?.[k];
            }
            return value || i18n['pt'][key] || key;
        }

        function changeLanguage(lang) {
            currentLang = lang;
            localStorage.setItem('planner_ultra_lang', lang);
            updateUI();
        }

        // ==========================================
        // INITIALIZATION
        // ==========================================
        


// FORCE OPEN - Esconde loading IMEDIATAMENTE
// FIXED: setTimeout(() => {
    const loading = document.getElementById('loading-screen');
    if (loading) loading.style.display = 'none';
    const auth = document.getElementById('auth-screen');
    if (auth) auth.style.display = 'flex';
    console.log('FORCED OPEN');
// }, 100);

// Inicializa√ß√£o b√°sica
document.addEventListener('DOMContentLoaded', () => {
    // FIXED: setTimeout(() => {
        document.getElementById('loading-screen').style.display = 'none';
        document.getElementById('auth-screen').style.display = 'flex';
    }, 200);
});

// Fun√ß√£o de inicializa√ß√£o simples
async function initializeApp() {
    document.getElementById('auth-screen').style.display = 'none';
    document.getElementById('main-app').style.display = 'block';
    planners = [{id:'p1', user_id: currentUser.id, name: 'Meu Planner'}];
    tasks = [];
    currentPlanner = planners[0];
}

    </script>

<!-- PLANNER ULTRA COMPLETE SCRIPT -->
<script>
auth-form');
    if (authForm) {
        authForm.addEventListener('submit', handleAuth);
        console.log('‚úÖ Auth form listener attached');
    }
    
    // Setup auth tabs
    document.querySelectorAll('.auth-tab').forEach(tab => {
        tab.addEventListener('click', function() {
            document.querySelectorAll('.auth-tab').forEach(t => t.classList.remove('active'));
            this.classList.add('active');
            
            const isSignup = this.dataset.tab === 'signup';
            const nameGroup = document.getElementById('name-group');
            const submitBtn = document.getElementById('auth-submit-btn');
            
            if (nameGroup) nameGroup.style.display = isSignup ? 'block' : 'none';
            if (submitBtn) submitBtn.querySelector('span').textContent = isSignup ? 'Criar Conta' : 'Entrar';
        });
    });
    
    // Setup tag input Enter key
    const tagInput = document.getElementById('tag-input');
    if (tagInput) {
        tagInput.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                e.preventDefault();
                addTag();
            }
        });
    }
    
    // Setup subtask input Enter key
    const subtaskInput = document.getElementById('subtask-input');
    if (subtaskInput) {
        subtaskInput.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                e.preventDefault();
                addSubtask();
            }
        });
    }
    
    console.log('‚úÖ Planner ULTRA fully initialized!');
});

// Make all functions globally accessible
window.switchTab = switchTab;
window.createPlanner = createPlanner;
window.openPlanner = openPlanner;
window.deletePlanner = deletePlanner;
window.closePlannerModal = closePlannerModal;
window.openTaskModal = openTaskModal;
window.closeTaskModal = closeTaskModal;
window.saveTask = saveTask;
window.toggleTask = toggleTask;
window.deleteTask = deleteTask;
window.setView = setView;
window.filterTasks = filterTasks;
window.addTag = addTag;
window.removeTag = removeTag;
window.addSubtask = addSubtask;
window.removeSubtask = removeSubtask;
window.closeLevelUpModal = closeLevelUpModal;
window.changeMonth = changeMonth;
window.openTemplate = openTemplate;
window.openTutorial = openTutorial;
window.exportCSV = exportCSV;
window.exportPDF = exportPDF;
window.copyCalendarUrl = copyCalendarUrl;
window.showPaywall = showPaywall;
window.subscribe = subscribe;
window.logout = logout;
window.changeLanguage = changeLanguage;

console.log('‚úÖ Planner ULTRA Complete v1.0 - All functions loaded!');

</script>

</body>
</html>




<!-- CRITICAL FIX: Proper initialization -->
<script>
window.addEventListener('load', function() {
    console.log('CRITICAL FIX: Page loaded, initializing...');
    setTimeout(function() {
        const loading = document.getElementById('loading-screen');
        const authScreen = document.getElementById('auth-screen');
        const mainApp = document.getElementById('main-app');
        
        if (loading) {
            loading.classList.add('hidden');
            loading.style.display = 'none';
        }
        
        // Check if user is logged in (demo mode)
        const hasUser = localStorage.getItem('planner_demo_user');
        
        if (hasUser && mainApp) {
            mainApp.style.display = 'block';
            if (authScreen) authScreen.style.display = 'none';
            console.log('User found, showing main app');
        } else if (authScreen) {
            authScreen.style.display = 'flex';
            if (mainApp) mainApp.style.display = 'none';
            console.log('No user, showing auth screen');
        }
    }, 500);
});

// Auto-login for demo mode
document.getElementById('auth-form')?.addEventListener('submit', function(e) {
    e.preventDefault();
    localStorage.setItem('planner_demo_user', 'demo');
    location.reload();
});
</script>
