<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#6B46C1">
    <meta name="description" content="Planner Premium ULTRA - Organize sua vida com gamifica√ß√£o e produtividade avan√ßada">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Planner ULTRA">
    <title>‚ú® Planner Premium ULTRA - Cutting Edge</title>
    
    <link rel="manifest" href="/manifest.json" crossorigin="use-credentials">
    <link rel="apple-touch-icon" href="/icon-152.png">
    
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bcryptjs/2.4.3/bcrypt.min.js"></script>
    
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        :root { 
            --primary: #6B46C1; --secondary: #EC4899; --success: #10B981; 
            --danger: #EF4444; --warning: #F59E0B; --dark: #1F2937; 
            --light: #F9FAFB; --gray: #E5E7EB; 
        }
        body { font-family: 'Segoe UI', sans-serif; background: linear-gradient(135deg, #667eea, #764ba2); color: var(--dark); min-height: 100vh; }
        
        @keyframes levelUp {
            0% { transform: scale(0.5) rotate(-10deg); opacity: 0; }
            50% { transform: scale(1.2) rotate(5deg); opacity: 1; }
            100% { transform: scale(1) rotate(0deg); opacity: 1; }
        }
        
        @keyframes confetti {
            0% { transform: translateY(0) rotate(0deg); opacity: 1; }
            100% { transform: translateY(100vh) rotate(720deg); opacity: 0; }
        }
        
        .confetti { position: fixed; width: 10px; height: 10px; z-index: 10000; pointer-events: none; }
        
        .level-up-modal {
            display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);
            z-index: 9999; background: white; padding: 3rem; border-radius: 20px;
            box-shadow: 0 25px 50px rgba(0,0,0,0.3); text-align: center; animation: levelUp 0.6s ease;
        }
        
        .level-up-modal.active { display: block; }
        .level-up-icon { font-size: 5em; margin-bottom: 1rem; }
        .level-up-title { font-size: 2em; font-weight: 800; background: linear-gradient(135deg, var(--primary), var(--secondary)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        
        .auth-container { min-height: 100vh; display: flex; align-items: center; justify-content: center; padding: 1rem; }
        .auth-box { background: white; border-radius: 20px; padding: 2rem; width: 100%; max-width: 400px; box-shadow: 0 25px 50px rgba(0,0,0,0.25); }
        .auth-logo { text-align: center; margin-bottom: 1.5rem; }
        .auth-logo-icon { font-size: 3em; }
        .auth-logo h1 { font-size: 1.4em; background: linear-gradient(135deg, var(--primary), var(--secondary)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; }
        .trial-badge { background: linear-gradient(135deg, #10B981, #059669); color: white; padding: 0.5rem 1rem; border-radius: 20px; font-size: 0.85em; font-weight: 700; margin: 0.8rem 0; display: inline-block; }
        .auth-tabs { display: flex; margin-bottom: 1.5rem; background: var(--gray); border-radius: 10px; padding: 4px; }
        .auth-tab { flex: 1; padding: 0.6rem; border: none; background: transparent; cursor: pointer; font-weight: 600; border-radius: 8px; color: #666; font-size: 0.9em; }
        .auth-tab.active { background: white; color: var(--primary); }
        .auth-form { display: none; }
        .auth-form.active { display: block; }
        .form-group { margin-bottom: 1rem; }
        .form-group label { display: block; margin-bottom: 0.3rem; font-weight: 600; font-size: 0.85em; }
        .form-group input { width: 100%; padding: 0.75rem; border: 2px solid var(--gray); border-radius: 8px; font-size: 1em; font-family: inherit; }
        .form-group input:focus { outline: none; border-color: var(--primary); }
        .btn-auth { width: 100%; padding: 0.9rem; border: none; border-radius: 10px; font-weight: 700; cursor: pointer; background: linear-gradient(135deg, var(--primary), var(--secondary)); color: white; font-size: 1em; }
        .btn-auth:disabled { opacity: 0.6; cursor: not-allowed; }
        .auth-msg { padding: 0.7rem; border-radius: 8px; margin-bottom: 1rem; font-size: 0.85em; display: none; }
        .auth-error { background: #FEE2E2; color: #DC2626; }
        .auth-success { background: #D1FAE5; color: #059669; }
        
        .trial-banner { padding: 1rem; text-align: center; font-weight: 700; font-size: 0.9em; }
        .trial-banner.warning { background: linear-gradient(135deg, #F59E0B, #D97706); color: white; }
        .trial-banner.danger { background: linear-gradient(135deg, #EF4444, #DC2626); color: white; animation: pulse 1.5s infinite; }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.8; } }
        
        .paywall-overlay { display: none; position: fixed; z-index: 9999; left: 0; top: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); align-items: center; justify-content: center; padding: 1rem; }
        .paywall-overlay.active { display: flex; }
        .paywall-box { background: white; border-radius: 20px; padding: 2.5rem; max-width: 500px; width: 100%; text-align: center; }
        .paywall-icon { font-size: 4em; margin-bottom: 1rem; }
        .paywall-title { font-size: 2em; font-weight: 800; margin-bottom: 0.5rem; background: linear-gradient(135deg, var(--primary), var(--secondary)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        
        .app-container { display: none; background: linear-gradient(135deg, #F9FAFB, #F3E8FF); min-height: 100vh; }
        .app-container.active { display: block; }
        .navbar { background: linear-gradient(135deg, var(--primary), var(--secondary)); color: white; padding: 1rem; display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 0.5rem; }
        .navbar-title { font-size: 1.2em; font-weight: 800; }
        .navbar-user { display: flex; align-items: center; gap: 0.5rem; flex-wrap: wrap; }
        .user-badge { background: rgba(255,255,255,0.2); padding: 0.4rem 0.8rem; border-radius: 15px; font-size: 0.75em; }
        .level-badge { background: linear-gradient(135deg, #F59E0B, #D97706); padding: 0.4rem 0.8rem; border-radius: 15px; font-size: 0.75em; font-weight: 700; cursor: pointer; }
        .streak-badge { background: linear-gradient(135deg, #EF4444, #DC2626); padding: 0.4rem 0.8rem; border-radius: 15px; font-size: 0.75em; font-weight: 700; }
        .btn-nav { background: rgba(255,255,255,0.2); border: 1px solid white; color: white; padding: 0.4rem 0.8rem; border-radius: 6px; cursor: pointer; font-weight: 600; font-size: 0.8em; }
        .btn-nav:hover { background: white; color: var(--primary); }
        
        .eco-banner { background: linear-gradient(135deg, #10B981, #059669); color: white; padding: 1rem; text-align: center; font-weight: 700; margin-bottom: 1rem; border-radius: 10px; }
        
        .tab-menu { display: flex; gap: 0.5rem; background: white; padding: 0.5rem; border-radius: 10px; margin: 1rem auto; max-width: 1200px; overflow-x: auto; flex-wrap: wrap; justify-content: center; }
        .tab-btn { padding: 0.7rem 1rem; border: none; background: transparent; cursor: pointer; font-weight: 600; border-radius: 6px; font-size: 0.9em; white-space: nowrap; }
        .tab-btn.active { background: linear-gradient(135deg, var(--primary), var(--secondary)); color: white; }
        
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        
        .container { max-width: 1400px; margin: 0 auto; padding: 1.5rem 1rem; }
        
        .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-bottom: 1.5rem; }
        .stat-card { background: white; border-radius: 12px; padding: 1.5rem; box-shadow: 0 4px 15px rgba(0,0,0,0.08); text-align: center; }
        .stat-value { font-size: 2em; font-weight: 800; color: var(--primary); }
        .stat-label { color: #666; font-size: 0.85em; margin-top: 0.3rem; }
        
        .xp-bar { background: var(--gray); border-radius: 20px; height: 30px; overflow: hidden; margin: 1rem 0; }
        .xp-fill { background: linear-gradient(135deg, #10B981, #059669); height: 100%; transition: width 0.5s ease; display: flex; align-items: center; justify-content: center; color: white; font-weight: 700; font-size: 0.85em; }
        
        .planner-types { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-bottom: 1.5rem; }
        .planner-card { background: white; border-radius: 12px; overflow: hidden; box-shadow: 0 4px 15px rgba(0,0,0,0.08); cursor: pointer; border-top: 4px solid; transition: transform 0.2s; }
        .planner-card:hover { transform: translateY(-3px); }
        .planner-header { color: white; padding: 1rem; text-align: center; }
        .planner-icon { font-size: 2em; }
        .planner-title { font-size: 0.95em; font-weight: 700; margin-top: 0.3rem; }
        .planner-body { padding: 1rem; }
        .btn-criar { width: 100%; padding: 0.6rem; background: linear-gradient(135deg, var(--primary), var(--secondary)); color: white; border: none; border-radius: 6px; font-weight: 700; cursor: pointer; font-size: 0.9em; }
        
        .planners-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 1rem; }
        .planner-item { color: white; border-radius: 10px; padding: 1rem; }
        .planner-item-nome { font-weight: 700; margin-bottom: 0.2rem; }
        .planner-item-info { font-size: 0.75em; opacity: 0.9; margin-bottom: 0.6rem; }
        .planner-item-acoes { display: flex; gap: 0.3rem; }
        .planner-item-acoes button { flex: 1; padding: 0.4rem; background: rgba(255,255,255,0.2); color: white; border: 1px solid white; border-radius: 4px; cursor: pointer; font-size: 0.7em; font-weight: 600; }
        
        .biblioteca-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 1rem; }
        .biblioteca-card { background: linear-gradient(135deg, #F3E8FF, #E9D5FF); border-radius: 10px; padding: 1.5rem; cursor: pointer; transition: all 0.3s; border: 2px solid transparent; }
        .biblioteca-card:hover { border-color: var(--primary); transform: translateY(-2px); }
        .biblioteca-icon { font-size: 2em; margin-bottom: 0.5rem; }
        .biblioteca-nome { font-weight: 700; color: var(--dark); margin-bottom: 0.3rem; }
        .biblioteca-desc { font-size: 0.85em; color: #666; }
        
        .tutorial-item { background: white; border-radius: 10px; padding: 1.5rem; margin-bottom: 1rem; cursor: pointer; transition: all 0.3s; border-left: 4px solid var(--primary); box-shadow: 0 4px 15px rgba(0,0,0,0.08); }
        .tutorial-item:hover { transform: translateX(5px); }
        .tutorial-nome { font-weight: 700; color: var(--dark); margin-bottom: 0.5rem; font-size: 1.05em; }
        .tutorial-preview { font-size: 0.9em; color: #666; line-height: 1.6; }
        
        .tarefa-item { background: var(--light); padding: 1rem; border-radius: 8px; margin-bottom: 0.8rem; border-left: 4px solid var(--primary); cursor: pointer; transition: all 0.2s; }
        .tarefa-item:hover { transform: translateX(5px); box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
        .tarefa-header { display: flex; gap: 0.8rem; align-items: flex-start; margin-bottom: 0.5rem; }
        .tarefa-checkbox { width: 20px; height: 20px; cursor: pointer; margin-top: 0.2rem; }
        .tarefa-conteudo { flex: 1; }
        .tarefa-titulo { font-weight: 700; font-size: 1em; margin-bottom: 0.3rem; }
        .tarefa-descricao { font-size: 0.85em; color: #666; margin-bottom: 0.5rem; }
        .tarefa-meta { display: flex; flex-wrap: wrap; gap: 0.5rem; font-size: 0.75em; color: #666; }
        .tarefa-meta-item { background: white; padding: 0.2rem 0.5rem; border-radius: 4px; }
        
        .modal { display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); overflow-y: auto; }
        .modal-content { background: white; margin: 2% auto; padding: 2rem; border-radius: 12px; width: 95%; max-width: 900px; max-height: 90vh; overflow-y: auto; }
        .modal-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem; border-bottom: 2px solid var(--gray); padding-bottom: 1rem; }
        .close-modal { font-size: 1.5em; cursor: pointer; background: none; border: none; color: #999; }
        
        .btn-primario { padding: 0.8rem 1.5rem; background: linear-gradient(135deg, var(--primary), var(--secondary)); color: white; border: none; border-radius: 8px; font-weight: 700; cursor: pointer; }
        
        @media (max-width: 768px) {
            .modal-content { width: 98%; padding: 1rem; }
            .tab-menu { flex-direction: column; }
            .tab-btn { width: 100%; }
        }
    </style>
</head>
<body>
    <!-- LOGIN/SIGNUP -->
    <div class="auth-container" id="authContainer">
        <div class="auth-box">
            <div class="auth-logo">
                <div class="auth-logo-icon">‚ú®</div>
                <h1>Planner Premium ULTRA</h1>
                <div class="trial-badge">üéÅ 7 dias gr√°tis ‚Ä¢ R$ 19,99/m√™s</div>
            </div>
            <div class="auth-tabs">
                <button class="auth-tab active" onclick="showTab('login')">Entrar</button>
                <button class="auth-tab" onclick="showTab('signup')">Criar Conta</button>
            </div>
            <div id="authError" class="auth-msg auth-error"></div>
            <div id="authSuccess" class="auth-msg auth-success"></div>

            <form id="loginForm" class="auth-form active" onsubmit="handleLogin(event)">
                <div class="form-group"><label>Email</label><input type="email" id="loginEmail" required></div>
                <div class="form-group"><label>Senha</label><input type="password" id="loginPassword" required></div>
                <button type="submit" class="btn-auth" id="loginBtn">Entrar</button>
            </form>

            <form id="signupForm" class="auth-form" onsubmit="handleSignup(event)">
                <div class="form-group"><label>Nome Completo</label><input type="text" id="signupName" required></div>
                <div class="form-group"><label>Email</label><input type="email" id="signupEmail" required></div>
                <div class="form-group"><label>Senha (m√≠n. 6)</label><input type="password" id="signupPassword" minlength="6" required></div>
                <button type="submit" class="btn-auth" id="signupBtn">üéÅ Come√ßar Trial Gr√°tis</button>
            </form>
        </div>
    </div>

    <!-- APP PRINCIPAL -->
    <div class="app-container" id="appContainer">
        <div class="navbar">
            <div class="navbar-title">‚ú® Planner Premium ULTRA</div>
            <div class="navbar-user">
                <span class="level-badge" id="levelBadge">‚≠ê N√≠vel 1</span>
                <span class="streak-badge" id="streakBadge">üî• 0 dias</span>
                <span class="user-badge">üë§ <span id="userName">User</span></span>
                <button class="btn-nav" onclick="logout()">Sair</button>
            </div>
        </div>

        <div class="eco-banner">
            üå± 100% Digital = Zero Papel | üìÑ Papel economizado: <strong id="paperSaved">0</strong> folhas | üåç √Årvores salvas: <strong id="treesSaved">0</strong>
        </div>

        <div class="container">
            <!-- ABAS PRINCIPAIS -->
            <div class="tab-menu">
                <button class="tab-btn active" onclick="openTab('planners')">üìã Planners</button>
                <button class="tab-btn" onclick="openTab('stats')">üìä Estat√≠sticas</button>
                <button class="tab-btn" onclick="openTab('achievements')">üèÜ Conquistas</button>
                <button class="tab-btn" onclick="openTab('biblioteca')">üìñ Biblioteca</button>
                <button class="tab-btn" onclick="openTab('tutoriais')">üìö Tutoriais</button>
                <button class="tab-btn" onclick="openTab('calendar')">üìÖ Calend√°rio</button>
            </div>

            <!-- ABA PLANNERS (SEU PLANNER ORIGINAL) -->
            <div id="plannersTab" class="tab-content active">
                <h2 style="margin-bottom:0.8rem;">Criar Novo Planner</h2>
                <div class="planner-types">
                    <div class="planner-card" style="border-top-color:#10B981;" onclick="criarPlanner('todo')">
                        <div class="planner-header" style="background:linear-gradient(135deg,#10B981,#059669);"><div class="planner-icon">‚úÖ</div><div class="planner-title">To-Do</div></div>
                        <div class="planner-body"><button class="btn-criar">Criar</button></div>
                    </div>
                    <div class="planner-card" style="border-top-color:#3B82F6;" onclick="criarPlanner('projeto')">
                        <div class="planner-header" style="background:linear-gradient(135deg,#3B82F6,#1D4ED8);"><div class="planner-icon">üèóÔ∏è</div><div class="planner-title">Projetos</div></div>
                        <div class="planner-body"><button class="btn-criar">Criar</button></div>
                    </div>
                    <div class="planner-card" style="border-top-color:#F59E0B;" onclick="criarPlanner('habitos')">
                        <div class="planner-header" style="background:linear-gradient(135deg,#F59E0B,#D97706);"><div class="planner-icon">üî•</div><div class="planner-title">H√°bitos</div></div>
                        <div class="planner-body"><button class="btn-criar">Criar</button></div>
                    </div>
                    <div class="planner-card" style="border-top-color:#8B5CF6;" onclick="criarPlanner('financeiro')">
                        <div class="planner-header" style="background:linear-gradient(135deg,#8B5CF6,#6D28D9);"><div class="planner-icon">üí∞</div><div class="planner-title">Financeiro</div></div>
                        <div class="planner-body"><button class="btn-criar">Criar</button></div>
                    </div>
                </div>
                <div style="background:white; border-radius:12px; padding:1.5rem; box-shadow: 0 4px 15px rgba(0,0,0,0.08);">
                    <h2 style="margin-bottom:1rem;">üìã Meus Planners</h2>
                    <div class="planners-grid" id="meusPlanners"></div>
                </div>
            </div>

            <!-- ABA ESTAT√çSTICAS -->
            <div id="statsTab" class="tab-content">
                <div class="stats-grid">
                    <div class="stat-card">
                        <div style="font-size: 2.5em; margin-bottom: 0.5rem;">‚≠ê</div>
                        <div class="stat-value" id="statLevel">1</div>
                        <div class="stat-label">N√≠vel</div>
                        <div class="xp-bar"><div class="xp-fill" id="xpBar" style="width:0%;">0/100 XP</div></div>
                    </div>
                    <div class="stat-card">
                        <div style="font-size: 2.5em; margin-bottom: 0.5rem;">üî•</div>
                        <div class="stat-value" id="statStreak">0</div>
                        <div class="stat-label">Dias de Streak</div>
                    </div>
                    <div class="stat-card">
                        <div style="font-size: 2.5em; margin-bottom: 0.5rem;">‚úÖ</div>
                        <div class="stat-value" id="statCompleted">0</div>
                        <div class="stat-label">Tarefas Conclu√≠das</div>
                    </div>
                </div>
            </div>

            <!-- ABA CONQUISTAS -->
            <div id="achievementsTab" class="tab-content">
                <h2 style="margin-bottom:1rem;">üèÜ Suas Conquistas</h2>
                <p style="text-align: center; color: #666;">Suas conquistas aparecer√£o aqui conforme voc√™ avan√ßa!</p>
            </div>

            <!-- ABA BIBLIOTECA (NOVO) -->
            <div id="bibliotecaTab" class="tab-content">
                <h2 style="margin-bottom:1.5rem; font-size:1.3em; font-weight:800;">üìñ Biblioteca Premium (900+ P√°ginas para Ler)</h2>
                <p style="margin-bottom:1.5rem; color:#666; font-size:0.95em;">Acesse templates prontos e aprenda com conte√∫do premium!</p>
                
                <h3 style="margin-bottom:1rem; font-weight:700;">üìÖ Planejadores Por Per√≠odo</h3>
                <div class="biblioteca-grid">
                    <div class="biblioteca-card" onclick="abrirBiblioteca('diario')">
                        <div class="biblioteca-icon">üìù</div>
                        <div class="biblioteca-nome">Planejador Di√°rio</div>
                        <div class="biblioteca-desc">365 p√°ginas di√°rias com metas do dia, reflex√£o e tracking</div>
                    </div>
                    <div class="biblioteca-card" onclick="abrirBiblioteca('semanal')">
                        <div class="biblioteca-icon">üìÜ</div>
                        <div class="biblioteca-nome">Planejador Semanal</div>
                        <div class="biblioteca-desc">52 p√°ginas semanais com cronograma e prioridades</div>
                    </div>
                    <div class="biblioteca-card" onclick="abrirBiblioteca('mensal')">
                        <div class="biblioteca-icon">üìä</div>
                        <div class="biblioteca-nome">Planejador Mensal</div>
                        <div class="biblioteca-desc">12 p√°ginas mensais com objetivos e tracking</div>
                    </div>
                    <div class="biblioteca-card" onclick="abrirBiblioteca('anual')">
                        <div class="biblioteca-icon">üéØ</div>
                        <div class="biblioteca-nome">Planejador Anual</div>
                        <div class="biblioteca-desc">Vis√£o completa do ano com metas e milestones</div>
                    </div>
                </div>

                <h3 style="margin-top:2rem; margin-bottom:1rem; font-weight:700;">üéØ Planejadores Tem√°ticos</h3>
                <div class="biblioteca-grid">
                    <div class="biblioteca-card" onclick="abrirBiblioteca('financeiro')">
                        <div class="biblioteca-icon">üí∞</div>
                        <div class="biblioteca-nome">Planejador Financeiro</div>
                        <div class="biblioteca-desc">Controle or√ßamento, despesas e investimentos</div>
                    </div>
                    <div class="biblioteca-card" onclick="abrirBiblioteca('saude')">
                        <div class="biblioteca-icon">üí™</div>
                        <div class="biblioteca-nome">Planejador de Sa√∫de</div>
                        <div class="biblioteca-desc">Tracking de exerc√≠cios, nutri√ß√£o e bem-estar</div>
                    </div>
                    <div class="biblioteca-card" onclick="abrirBiblioteca('leitura')">
                        <div class="biblioteca-icon">üìö</div>
                        <div class="biblioteca-nome">Rastreador de Leitura</div>
                        <div class="biblioteca-desc">Registre livros lidos, notas e resenhas</div>
                    </div>
                    <div class="biblioteca-card" onclick="abrirBiblioteca('viagem')">
                        <div class="biblioteca-icon">‚úàÔ∏è</div>
                        <div class="biblioteca-nome">Planejador de Viagens</div>
                        <div class="biblioteca-desc">Organize roteiros, or√ßamentos e itiner√°rios</div>
                    </div>
                    <div class="biblioteca-card" onclick="abrirBiblioteca('metas')">
                        <div class="biblioteca-icon">üéØ</div>
                        <div class="biblioteca-nome">Rastreador de Metas</div>
                        <div class="biblioteca-desc">Defina e acompanhe objetivos pessoais</div>
                    </div>
                    <div class="biblioteca-card" onclick="abrirBiblioteca('habitos')">
                        <div class="biblioteca-icon">üî•</div>
                        <div class="biblioteca-nome">Construtor de H√°bitos</div>
                        <div class="biblioteca-desc">Crie streaks e monitore novos h√°bitos</div>
                    </div>
                </div>
            </div>

            <!-- ABA TUTORIAIS (NOVO) -->
            <div id="tutoriaisTab" class="tab-content">
                <h2 style="margin-bottom:1.5rem; font-size:1.3em; font-weight:800;">üìö Tutoriais Completos (Saiba Como Usar)</h2>
                
                <div class="tutorial-item" onclick="abrirTutorial('comeco')">
                    <div class="tutorial-nome">üöÄ Como Come√ßar - Primeiros Passos</div>
                    <div class="tutorial-preview">Aprenda o b√°sico. Configure sua conta e crie seu primeiro planejador em minutos.</div>
                </div>

                <div class="tutorial-item" onclick="abrirTutorial('gamificacao')">
                    <div class="tutorial-nome">‚≠ê Sistema de Gamifica√ß√£o - Ganhe XP e Suba de N√≠vel</div>
                    <div class="tutorial-preview">Descubra como ganhar XP, subir de n√≠vel, manter streaks e desbloquear conquistas.</div>
                </div>

                <div class="tutorial-item" onclick="abrirTutorial('tarefas')">
                    <div class="tutorial-nome">‚úÖ Criando e Gerenciando Tarefas Avan√ßadas</div>
                    <div class="tutorial-preview">Domine a cria√ß√£o de tarefas com prioridades, subtarefas, lembretes, tags e muito mais.</div>
                </div>

                <div class="tutorial-item" onclick="abrirTutorial('kanban')">
                    <div class="tutorial-nome">üìä Utilizando a Visualiza√ß√£o Kanban</div>
                    <div class="tutorial-preview">Organize suas tarefas em colunas (A Fazer, Em Progresso, Conclu√≠do).</div>
                </div>

                <div class="tutorial-item" onclick="abrirTutorial('dicas')">
                    <div class="tutorial-nome">üìö Dicas de Produtividade com Gamifica√ß√£o</div>
                    <div class="tutorial-preview">T√©cnicas comprovadas para aumentar sua produtividade usando o Planner.</div>
                </div>
            </div>

            <!-- ABA CALEND√ÅRIO -->
            <div id="calendarTab" class="tab-content">
                <h2 style="margin-bottom:1rem;">üìÖ Calend√°rio</h2>
                <div style="background: white; border-radius: 12px; padding: 1.5rem; text-align: center;">
                    <p style="color: #666;">Integra√ß√£o com Google Calendar em desenvolvimento.</p>
                    <p style="color: #999; font-size: 0.9em; margin-top: 0.5rem;">Seus eventos aparecer√£o aqui automaticamente!</p>
                </div>
            </div>
        </div>
    </div>

    <!-- MODAL BIBLIOTECA -->
    <div id="modalBiblioteca" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="bibliotecaTitulo">Biblioteca</h2>
                <button class="close-modal" onclick="fecharModal('modalBiblioteca')">&times;</button>
            </div>
            <div id="bibliotecaConteudo" style="line-height: 1.8; color: #333;">
                <!-- Conte√∫do ser√° preenchido via JavaScript -->
            </div>
        </div>
    </div>

    <!-- MODAL TUTORIAL -->
    <div id="modalTutorial" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="tutorialTitulo">Tutorial</h2>
                <button class="close-modal" onclick="fecharModal('modalTutorial')">&times;</button>
            </div>
            <div id="tutorialConteudo" style="line-height: 1.8; color: #333;">
                <!-- Conte√∫do ser√° preenchido via JavaScript -->
            </div>
        </div>
    </div>

    <script>
        const SUPABASE_URL = 'https://szzirxygtjztusudfqsw.supabase.co';
        const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InN6emlyeHlndGp6dHVzdWRmcXN3Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjM4NDk0NzEsImV4cCI6MjA3OTQyNTQ3MX0.zEMDaMA-DvcSiHmj4a3thB1Nnu9cEWGqfFes8R8lICA';
        const STRIPE_LINK = 'https://buy.stripe.com/test_6oE14q0lh7iW5sA9AA';
        
        let supabase = null;
        let currentUser = null;
        let planners = [];

        // Conte√∫do da Biblioteca
        const bibliotecaConteudo = {
            'diario': { titulo: 'üìù Planejador Di√°rio', conteudo: '<h3>Planejador Di√°rio - 365 P√°ginas</h3><p>Uma p√°gina para cada dia do ano com estrutura otimizada.</p><h4 style="margin-top: 1.5rem;">Estrutura:</h4><ul style="margin-left: 1.5rem;"><li><strong>Data:</strong> Identifica√ß√£o clara do dia</li><li><strong>Metas do Dia:</strong> 3 metas principais</li><li><strong>Tarefas:</strong> Lista completa</li><li><strong>Reflex√£o:</strong> Como foi o dia?</li><li><strong>Gratid√£o:</strong> 3 coisas pelas quais √© grato</li></ul>' },
            'semanal': { titulo: 'üìÜ Planejador Semanal', conteudo: '<h3>Planejador Semanal - 52 P√°ginas</h3><p>Uma p√°gina para cada semana do ano. Vis√£o ampla dos compromissos.</p><h4 style="margin-top: 1.5rem;">Inclui:</h4><ul style="margin-left: 1.5rem;"><li>Objetivos da semana</li><li>Cronograma dia a dia</li><li>Prioridades</li><li>Review da semana</li></ul>' },
            'mensal': { titulo: 'üìä Planejador Mensal', conteudo: '<h3>Planejador Mensal - 12 P√°ginas</h3><p>Uma p√°gina para cada m√™s. Veja o panorama completo de 30 dias.</p><h4 style="margin-top: 1.5rem;">Se√ß√µes:</h4><ul style="margin-left: 1.5rem;"><li>Objetivos mensais</li><li>Calend√°rio visual</li><li>Eventos importantes</li><li>An√°lise do m√™s</li></ul>' },
            'anual': { titulo: 'üéØ Planejador Anual', conteudo: '<h3>Planejador Anual - Vis√£o Completa</h3><p>Uma p√°gina para todo o ano. Defina sua vis√£o anual.</p><h4 style="margin-top: 1.5rem;">Se√ß√µes:</h4><ul style="margin-left: 1.5rem;"><li>Metas por categoria (Sa√∫de, Financeiro, Relacionamentos)</li><li>Milestones do ano</li><li>Revis√£o trimestral</li><li>Reflex√£o final</li></ul>' },
            'financeiro': { titulo: 'üí∞ Planejador Financeiro', conteudo: '<h3>Planejador Financeiro</h3><p>Gerencie seu dinheiro com intelig√™ncia.</p><h4 style="margin-top: 1.5rem;">M√≥dulos:</h4><ul style="margin-left: 1.5rem;"><li>Or√ßamento mensal</li><li>Categorias de despesa</li><li>Investimentos</li><li>Metas financeiras</li><li>An√°lise mensal</li></ul>' },
            'saude': { titulo: 'üí™ Planejador de Sa√∫de', conteudo: '<h3>Planejador de Sa√∫de</h3><p>Rastreie exerc√≠cios, nutri√ß√£o, sono e bem-estar.</p><h4 style="margin-top: 1.5rem;">Rastreie:</h4><ul style="margin-left: 1.5rem;"><li>Exerc√≠cios di√°rios</li><li>Nutri√ß√£o e √°gua</li><li>Qualidade de sono</li><li>Sa√∫de mental</li><li>Consultas m√©dicas</li></ul>' },
            'leitura': { titulo: 'üìö Rastreador de Leitura', conteudo: '<h3>Rastreador de Leitura</h3><p>Organize sua leitura e n√£o esque√ßa das hist√≥rias.</p><h4 style="margin-top: 1.5rem;">Para cada livro:</h4><ul style="margin-left: 1.5rem;"><li>T√≠tulo e autor</li><li>G√™nero</li><li>Progresso de leitura</li><li>Resenha pessoal</li><li>Avalia√ß√£o</li><li>Aprendizados</li></ul>' },
            'viagem': { titulo: '‚úàÔ∏è Planejador de Viagens', conteudo: '<h3>Planejador de Viagens</h3><p>Organize cada detalhe da sua viagem.</p><h4 style="margin-top: 1.5rem;">Se√ß√µes:</h4><ul style="margin-left: 1.5rem;"><li>Destino e datas</li><li>Or√ßamento</li><li>Itiner√°rio di√°rio</li><li>Checklist de mala</li><li>Contatos importantes</li><li>Experi√™ncias desejadas</li></ul>' },
            'metas': { titulo: 'üéØ Rastreador de Metas', conteudo: '<h3>Rastreador de Metas</h3><p>Defina metas SMART e acompanhe progresso.</p><h4 style="margin-top: 1.5rem;">Para cada meta:</h4><ul style="margin-left: 1.5rem;"><li>Meta clara</li><li>Categoria</li><li>Prazo</li><li>Passos para chegar l√°</li><li>Progresso percentual</li><li>Revis√£o mensal</li></ul>' },
            'habitos': { titulo: 'üî• Construtor de H√°bitos', conteudo: '<h3>Construtor de H√°bitos - 66 Dias</h3><p>Crie novos h√°bitos positivos.</p><h4 style="margin-top: 1.5rem;">Rastreamento:</h4><ul style="margin-left: 1.5rem;"><li>Nome do h√°bito</li><li>Categoria</li><li>Frequ√™ncia</li><li>Checklist de 66 dias</li><li>Notas pessoais</li><li>Celebra√ß√£o de sucessos</li></ul>' }
        };

        // Conte√∫do dos Tutoriais
        const tutoriaisConteudo = {
            'comeco': { titulo: 'üöÄ Como Come√ßar', conteudo: '<h3>Bem-vindo!</h3><p>Vamos come√ßar em 5 passos:</p><ol style="margin-left: 1.5rem;"><li><strong>Crie sua conta:</strong> Email e senha. Ganhe 7 dias gr√°tis!</li><li><strong>Entre no app:</strong> Voc√™ ver√° o dashboard principal</li><li><strong>Crie um planner:</strong> Escolha To-Do, Projeto, H√°bitos ou Financeiro</li><li><strong>Adicione tarefas:</strong> Clique em "+ Nova Tarefa"</li><li><strong>Comece a usar:</strong> Marque tarefas como conclu√≠das e ganhe XP!</li></ol><p style="margin-top: 1.5rem;"><strong>üí° Dica:</strong> Comece com um √∫nico planejador!</p>' },
            'gamificacao': { titulo: '‚≠ê Gamifica√ß√£o', conteudo: '<h3>Sistema de Gamifica√ß√£o</h3><p>Ganhe XP e suba de n√≠vel completando tarefas!</p><h4 style="margin-top: 1.5rem;">Como Ganhar XP:</h4><ul style="margin-left: 1.5rem;"><li>Criar um planner: +50 XP</li><li>Criar uma tarefa: +30 XP</li><li>Completar uma tarefa: +20 XP</li><li>Manter streak: B√¥nus especial</li></ul><h4 style="margin-top: 1.5rem;">Streaks (Rajadas):</h4><p>Complete uma tarefa cada dia para manter seu streak! Quanto maior, mais motivador! üî•</p>' },
            'tarefas': { titulo: '‚úÖ Tarefas Avan√ßadas', conteudo: '<h3>Criando Tarefas Poderosas</h3><p>Tarefas s√£o o cora√ß√£o do Planner!</p><h4 style="margin-top: 1.5rem;">Campos:</h4><ul style="margin-left: 1.5rem;"><li><strong>T√≠tulo:</strong> O que precisa fazer</li><li><strong>Descri√ß√£o:</strong> Detalhes e contexto</li><li><strong>Data e Hora:</strong> Quando fazer</li><li><strong>Prioridade:</strong> Baixa, M√©dia, Alta, Urgente, Cr√≠tica</li><li><strong>Subtarefas:</strong> Divida em passos pequenos</li><li><strong>Lembretes:</strong> Receba notifica√ß√µes</li><li><strong>Tags:</strong> Organize por temas</li></ul>' },
            'kanban': { titulo: 'üìä Visualiza√ß√£o Kanban', conteudo: '<h3>O M√©todo Kanban</h3><p>Veja suas tarefas em 3 colunas:</p><ul style="margin-left: 1.5rem;"><li>üìã A Fazer</li><li>üöÄ Em Progresso</li><li>‚úÖ Conclu√≠do</li></ul><h4 style="margin-top: 1.5rem;">Como usar:</h4><ol style="margin-left: 1.5rem;"><li>Crie suas tarefas normalmente</li><li>Abra o planner e clique em "Kanban"</li><li>Arraste tarefas entre colunas</li><li>Visualize seu fluxo de trabalho</li></ol>' },
            'dicas': { titulo: 'üìö Dicas de Produtividade', conteudo: '<h3>T√©cnicas Comprovadas</h3><h4>1. Regra dos 3</h4><p>Escolha 3 tarefas principais cada dia. Foco total nelas!</p><h4>2. Technique Pomodoro</h4><p>Trabalhe 25 min, descanse 5. Use a dura√ß√£o das tarefas!</p><h4>3. Kanban</h4><p>Limite de 3-5 tarefas em progresso. Termine antes de come√ßar nova!</p><h4>4. Contexto</h4><p>Agrupe tarefas por local: Casa, Escrit√≥rio, Online.</p><h4>5. Mantenha Streaks</h4><p>Complete algo todo dia. Mesmo a√ß√µes pequenas contam!</p>' }
        };

        async function init() {
            try {
                supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_KEY);
                document.getElementById('authContainer').style.display = 'flex';
                updateEcoCounter();
            } catch (err) {
                console.error('Erro:', err);
            }
        }

        function updateEcoCounter() {
            const paperSaved = Math.floor(Math.random() * 1000) + 500;
            const treesSaved = Math.floor(paperSaved / 8333);
            document.getElementById('paperSaved').textContent = paperSaved;
            document.getElementById('treesSaved').textContent = treesSaved;
        }

        function showTab(t) {
            document.querySelectorAll('.auth-tab').forEach((el,i) => el.classList.toggle('active', (t==='login'&&i===0)||(t==='signup'&&i===1)));
            document.getElementById('loginForm').classList.toggle('active', t==='login');
            document.getElementById('signupForm').classList.toggle('active', t==='signup');
            hideMsg();
        }
        
        function showError(m) { 
            document.getElementById('authError').textContent=m; 
            document.getElementById('authError').style.display='block'; 
            document.getElementById('authSuccess').style.display='none'; 
        }
        
        function showSuccess(m) { 
            document.getElementById('authSuccess').textContent=m; 
            document.getElementById('authSuccess').style.display='block'; 
            document.getElementById('authError').style.display='none'; 
        }
        
        function hideMsg() { 
            document.getElementById('authError').style.display='none'; 
            document.getElementById('authSuccess').style.display='none'; 
        }

        async function handleSignup(e) {
            e.preventDefault();
            const name = document.getElementById('signupName').value.trim();
            const email = document.getElementById('signupEmail').value.trim().toLowerCase();
            const pass = document.getElementById('signupPassword').value;
            
            if (pass.length < 6) { showError('‚ùå Senha deve ter m√≠nimo 6 caracteres!'); return; }
            
            document.getElementById('signupBtn').disabled = true;
            document.getElementById('signupBtn').textContent = 'Criando...';
            
            try {
                const { data: existing } = await supabase.from('users').select('email').eq('email', email).single();
                if (existing) {
                    showError('‚ùå Email j√° cadastrado!');
                    document.getElementById('signupBtn').disabled = false;
                    document.getElementById('signupBtn').textContent = 'üéÅ Come√ßar Trial Gr√°tis';
                    return;
                }
                
                const hashedPassword = await bcrypt.hash(pass, 10);
                const trialEndDate = new Date();
                trialEndDate.setDate(trialEndDate.getDate() + 7);
                
                const { data: user, error } = await supabase.from('users').insert([{ 
                    email, name, password: hashedPassword,
                    trial_end: trialEndDate.toISOString().split('T')[0],
                    subscription_status: 'trial',
                    xp: 0, level: 1, streak: 0, last_activity: new Date().toISOString().split('T')[0]
                }]).select().single();
                
                if (error) throw error;
                showSuccess('‚úÖ Conta criada! 7 dias gr√°tis ativados!');
                setTimeout(() => loginUser(user), 1500);
            } catch (err) {
                console.error('Erro:', err);
                showError('‚ùå Erro ao criar conta');
                document.getElementById('signupBtn').disabled = false;
                document.getElementById('signupBtn').textContent = 'üéÅ Come√ßar Trial Gr√°tis';
            }
        }

        async function handleLogin(e) {
            e.preventDefault();
            const email = document.getElementById('loginEmail').value.trim().toLowerCase();
            const pass = document.getElementById('loginPassword').value;
            
            document.getElementById('loginBtn').disabled = true;
            document.getElementById('loginBtn').textContent = 'Entrando...';
            
            try {
                const { data: user, error } = await supabase.from('users').select('*').eq('email', email).single();
                if (error || !user) {
                    showError('‚ùå Email n√£o encontrado!');
                    document.getElementById('loginBtn').disabled = false;
                    document.getElementById('loginBtn').textContent = 'Entrar';
                    return;
                }
                
                const isValid = await bcrypt.compare(pass, user.password);
                if (!isValid) {
                    showError('‚ùå Senha incorreta!');
                    document.getElementById('loginBtn').disabled = false;
                    document.getElementById('loginBtn').textContent = 'Entrar';
                    return;
                }
                
                loginUser(user);
            } catch (err) {
                console.error('Erro:', err);
                showError('‚ùå Erro ao fazer login');
                document.getElementById('loginBtn').disabled = false;
                document.getElementById('loginBtn').textContent = 'Entrar';
            }
        }

        async function loginUser(user) {
            currentUser = user;
            
            document.getElementById('authContainer').style.display = 'none';
            document.getElementById('appContainer').classList.add('active');
            document.getElementById('userName').textContent = user.name.split(' ')[0];
            document.getElementById('levelBadge').textContent = `‚≠ê N√≠vel ${user.level || 1}`;
            document.getElementById('streakBadge').textContent = `üî• ${user.streak || 0} dias`;
            
            updateEcoCounter();
        }

        function openTab(tab) {
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            
            const tabs = ['planners', 'stats', 'achievements', 'biblioteca', 'tutoriais', 'calendar'];
            const index = tabs.indexOf(tab);
            if (index !== -1) {
                document.querySelectorAll('.tab-btn')[index].classList.add('active');
                document.getElementById(tab + 'Tab').classList.add('active');
            }
        }

        function abrirBiblioteca(tipo) {
            const conteudo = bibliotecaConteudo[tipo];
            if (!conteudo) return;
            
            document.getElementById('bibliotecaTitulo').textContent = conteudo.titulo;
            document.getElementById('bibliotecaConteudo').innerHTML = conteudo.conteudo;
            document.getElementById('modalBiblioteca').style.display = 'block';
        }

        function abrirTutorial(tipo) {
            const conteudo = tutoriaisConteudo[tipo];
            if (!conteudo) return;
            
            document.getElementById('tutorialTitulo').textContent = conteudo.titulo;
            document.getElementById('tutorialConteudo').innerHTML = conteudo.conteudo;
            document.getElementById('modalTutorial').style.display = 'block';
        }

        function fecharModal(id) {
            document.getElementById(id).style.display = 'none';
        }

        function logout() {
            if (confirm('Deseja realmente sair?')) {
                currentUser = null;
                document.getElementById('appContainer').classList.remove('active');
                document.getElementById('authContainer').style.display = 'flex';
                document.getElementById('loginEmail').value = '';
                document.getElementById('loginPassword').value = '';
            }
        }

        window.onclick = e => {
            if (e.target.classList.contains('modal')) e.target.style.display = 'none';
        };

        init();
    </script>
</body>
</html>
